import{r as A,J as W,t as Z,R as w,j as e,Q as G}from"./app-D2e3E3XV.js";import{I as H,A as K,C as s,l as Q,k as q,S as X}from"./AdminSidebarLayout-COqDSJm5.js";import{B as ee,D as te,C as re,a as ne,L as oe,b as ae,p as se,c as ie,d as le,A as ce}from"./index-DKUnvtKQ.js";import{A as me}from"./index-Dv79h3uU.js";import{R as g,C as i}from"./row-C-LMzcQh.js";import{S as c}from"./index-Vi_lAG7p.js";import{R as de}from"./BankOutlined-l5YwWDwk.js";import{R as C,a as I}from"./RiseOutlined-BMm2ma02.js";import{R as D}from"./ExclamationCircleOutlined-JAQupyzN.js";import{S as ue}from"./index-dQJIm9ox.js";import{F as E}from"./Table-BwkSv8cC.js";import{E as h}from"./index-DD8aZ74l.js";import{T as pe}from"./index-DlUzflYL.js";import{T as R}from"./index-m_fbIKNS.js";import"./SessionTimeout-CfqEmPbo.js";import"./Modal-J3vqZBmM.js";import"./transition-BB8nYaSI.js";import"./PrimaryButton-CAxNNQMa.js";import"./SecondaryButton-DEXX7yh7.js";import"./CheckCircleFilled-BiH3Zm4C.js";import"./InfoCircleFilled-bVzp4Yp4.js";import"./useIcons-Bk-sqBIx.js";import"./getAllowClear-BoT9aE4f.js";import"./DownOutlined-D3g4QtBj.js";import"./useForm-D6sLoAH1.js";import"./index-B8k0MQXY.js";import"./Input-xs5RiVsA.js";import"./EditOutlined-DJbavOcF.js";import"./TextArea-Ba86vcsD.js";var xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"};function y(){return y=Object.assign?Object.assign.bind():function(o){for(var l=1;l<arguments.length;l++){var d=arguments[l];for(var u in d)Object.prototype.hasOwnProperty.call(d,u)&&(o[u]=d[u])}return o},y.apply(this,arguments)}const he=(o,l)=>A.createElement(H,y({},o,{ref:l,icon:xe})),ge=A.forwardRef(he);re.register(ne,oe,ae,se,ie,le,ce);const{Text:fe,Title:Xe}=pe,n=o=>new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS",minimumFractionDigits:0,maximumFractionDigits:0}).format(o),je=o=>{if(!o)return"No date";const l=new Date(o);return isNaN(l.getTime())?"Invalid date":l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};function et(){const{memberCount:o=0,contributionSum:l=0,disasterPaymentSum:d=0,loanSum:u=0,activeMembers:f=0,monthlyContributions:N=[],recentContributions:$=[],recentDisasterPayments:k=[],recentLoans:M=[],accountingSummary:B={},accountBalances:ye={},topAccounts:be=[]}=W().props,{cash_balance:b=0,total_revenue:F=0,total_expenses:z=0,net_income:p=0,recent_entries:L=[],entries_count_today:ve=0,entries_count_month:Se=0}=B,{token:a}=Z.useToken(),[v,O]=w.useState(new Date().getFullYear()),S=new Date().getFullYear(),P=w.useMemo(()=>{const t=[];for(let r=S;r>=2018;r--)t.push({label:r.toString(),value:r});return t},[S]),T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((t,r)=>{const m=N.find(x=>{const _=new Date(x.month+"-01");return _.getMonth()===r&&_.getFullYear()===v});return{month:t,amount:m?m.total:0}}),J={labels:T.map(t=>t.month),datasets:[{label:"Monthly Contributions",data:T.map(t=>t.amount),backgroundColor:a.colorPrimary,borderColor:a.colorPrimary,borderRadius:4,borderWidth:2}]},Y={labels:["Active","Inactive"],datasets:[{data:[f,o-f],backgroundColor:[a.colorSuccess,a.colorTextSecondary],borderColor:a.colorBgContainer,borderWidth:2}]},j=[...$.map(t=>{var r;return{id:`contribution-${t.id}`,description:`Contribution of ${n(t.amount)} from ${((r=t.member)==null?void 0:r.name)||"Unknown"}`,type:"contribution",created_at:t.payment_date||t.created_at}}),...k.map(t=>{var r;return{id:`disaster-${t.id}`,description:`Disaster payment of ${n(t.amount)} to ${((r=t.member)==null?void 0:r.name)||"Unknown"}`,type:"disaster",created_at:t.date||t.created_at}}),...M.map(t=>{var r;return{id:`loan-${t.id}`,description:`Loan of ${n(t.amount)} disbursed to ${((r=t.member)==null?void 0:r.name)||"Unknown"} - ${t.purpose}`,type:"loan",created_at:t.created_at}})].sort((t,r)=>{const m=new Date(t.created_at),x=new Date(r.created_at);return isNaN(m.getTime())&&isNaN(x.getTime())?0:isNaN(m.getTime())?1:isNaN(x.getTime())?-1:x-m}).slice(0,5),U=[{title:"Entry #",dataIndex:"entry_number",key:"entry_number",width:120,render:t=>e.jsx(fe,{code:!0,style:{fontSize:"11px"},children:t})},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0,render:t=>e.jsx("span",{style:{fontSize:"12px"},children:t})},{title:"Amount",dataIndex:"total_debit",key:"amount",width:100,align:"right",render:t=>e.jsx("span",{style:{fontSize:"12px"},children:n(t)})},{title:"Status",dataIndex:"status",key:"status",width:80,render:t=>e.jsx(R,{color:t==="posted"?"green":t==="draft"?"orange":"red",style:{fontSize:"10px"},children:t.toUpperCase()})}],V=[{title:"Activity",dataIndex:"description",key:"description",width:"50%"},{title:"Type",dataIndex:"type",key:"type",width:"25%",render:t=>{const r={member:"blue",contribution:"green",penalty:"red",disaster:"orange",loan:"purple",system:"default"};return e.jsx(R,{color:r[t]||"default",children:t})}},{title:"Date",dataIndex:"created_at",key:"created_at",width:"25%",render:t=>je(t)}];return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Dashboard - Tabata Welfare Association"}),e.jsxs(K,{children:[p<0&&e.jsx(me,{message:"Financial Alert",description:`Net income is negative (${n(p)}). Review expenses and revenue streams.`,type:"warning",showIcon:!0,closable:!0,style:{marginBottom:24}}),e.jsxs(g,{gutter:16,style:{marginBottom:24},children:[e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Total Members",value:o,prefix:e.jsx(Q,{}),suffix:`(${f} active)`})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Cash Balance",value:b,prefix:e.jsx(de,{}),formatter:t=>n(t),valueStyle:{color:b>=0?a.colorSuccess:a.colorError}})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Total Revenue",value:F,prefix:e.jsx(C,{}),formatter:t=>n(t),valueStyle:{color:a.colorSuccess}})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Net Income",value:p,prefix:p>=0?e.jsx(C,{}):e.jsx(I,{}),formatter:t=>n(t),valueStyle:{color:p>=0?a.colorSuccess:a.colorError}})})})]}),e.jsxs(g,{gutter:16,style:{marginBottom:24},children:[e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Total Contributions",value:l,prefix:e.jsx(q,{}),formatter:t=>n(t)})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Total Expenses",value:z,prefix:e.jsx(I,{}),formatter:t=>n(t),valueStyle:{color:a.colorError}})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Disaster Payments",value:d,prefix:e.jsx(D,{}),formatter:t=>n(t)})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(s,{children:e.jsx(c,{title:"Outstanding Loans",value:u,prefix:e.jsx(D,{}),formatter:t=>n(t),valueStyle:{color:a.colorWarning}})})})]}),e.jsxs(g,{gutter:16,style:{marginBottom:24},children:[e.jsx(i,{xs:24,lg:12,children:e.jsx(s,{title:"Monthly Contributions Trend",extra:e.jsx(ue,{value:v,onChange:O,options:P,style:{width:100}}),children:e.jsx(ee,{data:J,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,ticks:{callback:function(t){return n(t)}}}}}})})}),e.jsx(i,{xs:24,lg:12,children:e.jsx(s,{title:"Member Status",children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px"},children:e.jsx("div",{style:{width:"160px",height:"160px"},children:e.jsx(te,{data:Y,options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"bottom"}}}})})})})})]}),e.jsxs(g,{gutter:16,children:[e.jsx(i,{xs:24,lg:12,children:e.jsx(s,{title:e.jsxs(X,{children:[e.jsx(ge,{}),"Recent Journal Entries"]}),size:"small",children:e.jsx(E,{columns:U,dataSource:L,rowKey:"id",size:"small",pagination:!1,locale:{emptyText:e.jsx(h,{description:"No recent journal entries",image:h.PRESENTED_IMAGE_SIMPLE})}})})}),e.jsx(i,{xs:24,lg:12,children:e.jsx(s,{title:"Recent Activities",children:j&&j.length>0?e.jsx(E,{columns:V,dataSource:j,rowKey:"id",pagination:!1,size:"small",locale:{emptyText:e.jsx(h,{description:"No recent activities",image:h.PRESENTED_IMAGE_SIMPLE})}}):e.jsx(h,{description:"No recent activities"})})})]})]})]})}export{et as default};
