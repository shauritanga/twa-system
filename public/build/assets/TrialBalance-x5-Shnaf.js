import{R as h,c as E,C as de,k as te,u as pe,v as me,r as w,e as ue,b as P,az as ge,n as ye,f as fe,d as xe,t as be,j as r,Q as he,S as U}from"./app-Cfy4TXUM.js";import{aw as K,K as Q,u as $e,x as Ce,c as Se,m as ve,a0 as je,y as Ne,i as Te,d as Ie,$ as Pe,a2 as we,s as Ee,A as Ae,S as V,B as G}from"./AdminSidebarLayout-Buj-taLG.js";import{d as H}from"./dayjs.min-CQ88ldzR.js";import{C as z}from"./index-mG9EyX9P.js";import{A as Be}from"./index-B5CpmtyB.js";import{R as Re}from"./CheckCircleOutlined-D3khjOz4.js";import{R as _e}from"./CloseCircleOutlined-mKdyCeJY.js";import{D as Me}from"./index-B7DGN-AY.js";import{S as J}from"./index-BH-hJvoT.js";import{R as ke}from"./useIcons-C0CVJH8d.js";import{R as He}from"./DownloadOutlined-wtaD_--B.js";import{T as Oe}from"./index-BAjCEJt5.js";import{F as O}from"./Table-BDJDT3yO.js";import{T as ee}from"./index-eYiOuDe6.js";import"./SessionTimeout-Dn5jdFb_.js";import"./Modal-dSY3wv-x.js";import"./transition-CwSGfga5.js";import"./PrimaryButton-D3tyYlDf.js";import"./SecondaryButton-HhmXi8wu.js";import"./CheckCircleFilled-JrBW7ofW.js";import"./InfoCircleFilled-Ce035z5p.js";import"./CalendarOutlined-Dc2SfXVk.js";import"./ClockCircleOutlined-BEpyFDSv.js";import"./index-BqBQ4c5d.js";import"./getAllowClear-CEhEtxYT.js";import"./DownOutlined-D7IvzF20.js";import"./EditOutlined-DIT7bWP5.js";import"./TextArea-kKKIj_tr.js";import"./useForm-WxDJKNk0.js";import"./scrollTo-CLqcVzDY.js";import"./index-Du1U9e5C.js";import"./Input-CfZxHJYv.js";const Ke=h.forwardRef((a,e)=>{const{prefixCls:t,forceRender:o,className:n,style:i,children:y,isActive:m,role:l,classNames:d,styles:p}=a,[f,$]=h.useState(m||o);return h.useEffect(()=>{(o||m)&&$(!0)},[o,m]),f?h.createElement("div",{ref:e,className:E(`${t}-panel`,{[`${t}-panel-active`]:m,[`${t}-panel-inactive`]:!m},n),style:i,role:l},h.createElement("div",{className:E(`${t}-body`,d==null?void 0:d.body),style:p==null?void 0:p.body},y)):null}),re=h.forwardRef((a,e)=>{const{showArrow:t=!0,headerClass:o,isActive:n,onItemClick:i,forceRender:y,className:m,classNames:l={},styles:d={},prefixCls:p,collapsible:f,accordion:$,panelKey:s,extra:c,header:v,expandIcon:T,openMotion:j,destroyOnHidden:u,children:I,...C}=a,N=f==="disabled",S=c!=null&&typeof c!="boolean",x={onClick:()=>{i==null||i(s)},onKeyDown:R=>{(R.key==="Enter"||R.keyCode===Q.ENTER||R.which===Q.ENTER)&&(i==null||i(s))},role:$?"tab":"button","aria-expanded":n,"aria-disabled":N,tabIndex:N?-1:0},b=typeof T=="function"?T(a):h.createElement("i",{className:"arrow"}),g=b&&h.createElement("div",K({className:E(`${p}-expand-icon`,l==null?void 0:l.icon),style:d==null?void 0:d.icon},["header","icon"].includes(f)?x:{}),b),B=E(`${p}-item`,{[`${p}-item-active`]:n,[`${p}-item-disabled`]:N},m),k={className:E(o,`${p}-header`,{[`${p}-collapsible-${f}`]:!!f},l==null?void 0:l.header),style:d==null?void 0:d.header,...["header","icon"].includes(f)?{}:x};return h.createElement("div",K({},C,{ref:e,className:B}),h.createElement("div",k,t&&g,h.createElement("span",K({className:E(`${p}-title`,l==null?void 0:l.title),style:d==null?void 0:d.title},f==="header"?x:{}),v),S&&h.createElement("div",{className:`${p}-extra`},c)),h.createElement(de,K({visible:n,leavedClassName:`${p}-panel-hidden`},j,{forceRender:y,removeOnLeave:u}),({className:R,style:Y},D)=>h.createElement(Ke,{ref:D,prefixCls:p,className:R,classNames:l,style:Y,styles:d,isActive:n,forceRender:y,role:$?"tabpanel":void 0},I)))});function ne(a,e,t){if(!a||!e)return a||e;const o=Array.from(new Set([...Object.keys(a),...Object.keys(e)])),n={};return o.forEach(i=>{n[i]=t(a[i],e[i])}),n}function De(a,e){return ne(a,e,(t,o)=>E(t,o))}function Le(a,e){return ne(a,e,(t,o)=>({...t,...o}))}const ze=(a,e)=>{const{prefixCls:t,accordion:o,collapsible:n,destroyOnHidden:i,onItemClick:y,activeKey:m,openMotion:l,expandIcon:d,classNames:p,styles:f}=e;return a.map(($,s)=>{const{children:c,label:v,key:T,collapsible:j,onItemClick:u,destroyOnHidden:I,classNames:C,styles:N,...S}=$,x=String(T??s),b=j??n,g=I??i,B=k=>{b!=="disabled"&&(y(k),u==null||u(k))};let A=!1;return o?A=m[0]===x:A=m.indexOf(x)>-1,h.createElement(re,K({},S,{classNames:De(p,C),styles:Le(f,N),prefixCls:t,key:x,panelKey:x,isActive:A,accordion:o,openMotion:l,expandIcon:d,header:v,collapsible:b,onItemClick:B,destroyOnHidden:g}),c)})},Ye=(a,e,t)=>{if(!a)return null;const{prefixCls:o,accordion:n,collapsible:i,destroyOnHidden:y,onItemClick:m,activeKey:l,openMotion:d,expandIcon:p,classNames:f,styles:$}=t,s=a.key||String(e),{header:c,headerClass:v,destroyOnHidden:T,collapsible:j,onItemClick:u}=a.props;let I=!1;n?I=l[0]===s:I=l.indexOf(s)>-1;const C=j??i,N=x=>{C!=="disabled"&&(m(x),u==null||u(x))},S={key:s,panelKey:s,header:c,headerClass:v,classNames:f,styles:$,isActive:I,prefixCls:o,destroyOnHidden:T??y,openMotion:d,accordion:n,children:a.props.children,onItemClick:N,expandIcon:p,collapsible:C};return typeof a.type=="string"?a:(Object.keys(S).forEach(x=>{typeof S[x]>"u"&&delete S[x]}),h.cloneElement(a,S))};function Fe(a,e,t){return Array.isArray(a)?ze(a,t):te(e).map((o,n)=>Ye(o,n,t))}function ae(a){let e=a;if(!Array.isArray(e)){const t=typeof e;e=t==="number"||t==="string"?[e]:[]}return e.map(t=>String(t))}const Ge=h.forwardRef((a,e)=>{const{prefixCls:t="rc-collapse",destroyOnHidden:o=!1,style:n,accordion:i,className:y,children:m,collapsible:l,openMotion:d,expandIcon:p,activeKey:f,defaultActiveKey:$,onChange:s,items:c,classNames:v,styles:T}=a,j=E(t,y),[u,I]=$e($,f),C=ae(u),N=pe(b=>{const g=ae(b);I(g),s==null||s(g)}),S=b=>{N(i?C[0]===b?[]:[b]:C.includes(b)?C.filter(g=>g!==b):[...C,b])};me(!m,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");const x=Fe(c,m,{prefixCls:t,accordion:i,openMotion:d,expandIcon:p,collapsible:l,destroyOnHidden:o,onItemClick:S,activeKey:C,classNames:v,styles:T});return h.createElement("div",K({ref:e,className:j,style:n,role:i?"tablist":void 0},Ce(a,{aria:!0,data:!0})),x)}),W=Object.assign(Ge,{Panel:re}),{Panel:Ra}=W,Ze=w.forwardRef((a,e)=>{const{getPrefixCls:t}=w.useContext(ue),{prefixCls:o,className:n,showArrow:i=!0}=a,y=t("collapse",o),m=E({[`${y}-no-arrow`]:!i},n);return w.createElement(W.Panel,{ref:e,...a,prefixCls:y,className:m})}),We=a=>{const{componentCls:e,contentBg:t,padding:o,headerBg:n,headerPadding:i,collapseHeaderPaddingSM:y,collapseHeaderPaddingLG:m,collapsePanelBorderRadius:l,lineWidth:d,lineType:p,colorBorder:f,colorText:$,colorTextHeading:s,colorTextDisabled:c,fontSizeLG:v,lineHeight:T,lineHeightLG:j,marginSM:u,paddingSM:I,paddingLG:C,paddingXS:N,motionDurationSlow:S,fontSizeIcon:x,contentPadding:b,fontHeight:g,fontHeightLG:B}=a,A=`${P(d)} ${p} ${f}`;return{[e]:{...fe(a),backgroundColor:n,border:A,borderRadius:l,"&-rtl":{direction:"rtl"},[`& > ${e}-item`]:{borderBottom:A,"&:first-child":{[`
            &,
            & > ${e}-header`]:{borderRadius:`${P(l)} ${P(l)} 0 0`}},"&:last-child":{[`
            &,
            & > ${e}-header`]:{borderRadius:`0 0 ${P(l)} ${P(l)}`}},[`> ${e}-header`]:{position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:i,color:s,lineHeight:T,cursor:"pointer",transition:`all ${S}, visibility 0s`,...ye(a),[`> ${e}-title`]:{flex:"auto"},[`${e}-expand-icon`]:{height:g,display:"flex",alignItems:"center",marginInlineEnd:u},[`${e}-arrow`]:{...ge(),fontSize:x,transition:`transform ${S}`,svg:{transition:`transform ${S}`}},[`${e}-title`]:{marginInlineEnd:"auto"}},[`${e}-collapsible-header`]:{cursor:"default",[`${e}-title`]:{flex:"none",cursor:"pointer"},[`${e}-expand-icon`]:{cursor:"pointer"}},[`${e}-collapsible-icon`]:{cursor:"unset",[`${e}-expand-icon`]:{cursor:"pointer"}}},[`${e}-panel`]:{color:$,backgroundColor:t,borderTop:A,[`& > ${e}-body`]:{padding:b},"&-hidden":{display:"none"}},"&-small":{[`> ${e}-item`]:{[`> ${e}-header`]:{padding:y,paddingInlineStart:N,[`> ${e}-expand-icon`]:{marginInlineStart:a.calc(I).sub(N).equal()}},[`> ${e}-panel > ${e}-body`]:{padding:I}}},"&-large":{[`> ${e}-item`]:{fontSize:v,lineHeight:j,[`> ${e}-header`]:{padding:m,paddingInlineStart:o,[`> ${e}-expand-icon`]:{height:B,marginInlineStart:a.calc(C).sub(o).equal()}},[`> ${e}-panel > ${e}-body`]:{padding:C}}},[`${e}-item:last-child`]:{borderBottom:0,[`> ${e}-panel`]:{borderRadius:`0 0 ${P(l)} ${P(l)}`}},[`& ${e}-item-disabled > ${e}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:c,cursor:"not-allowed"}},[`&${e}-icon-placement-end`]:{[`& > ${e}-item`]:{[`> ${e}-header`]:{[`${e}-expand-icon`]:{order:1,marginInlineEnd:0,marginInlineStart:u}}}}}}},qe=a=>{const{componentCls:e}=a,t=`> ${e}-item > ${e}-header ${e}-arrow`;return{[`${e}-rtl`]:{[t]:{transform:"rotate(180deg)"}}}},Xe=a=>{const{componentCls:e,headerBg:t,borderlessContentPadding:o,borderlessContentBg:n,colorBorder:i}=a;return{[`${e}-borderless`]:{backgroundColor:t,border:0,[`> ${e}-item`]:{borderBottom:`1px solid ${i}`},[`
        > ${e}-item:last-child,
        > ${e}-item:last-child ${e}-header
      `]:{borderRadius:0},[`> ${e}-item:last-child`]:{borderBottom:0},[`> ${e}-item > ${e}-panel`]:{backgroundColor:n,borderTop:0},[`> ${e}-item > ${e}-panel > ${e}-body`]:{padding:o}}}},Ue=a=>{const{componentCls:e,paddingSM:t}=a;return{[`${e}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${e}-item`]:{borderBottom:0,[`> ${e}-panel`]:{backgroundColor:"transparent",border:0,[`> ${e}-body`]:{paddingBlock:t}}}}}},Qe=a=>({headerPadding:`${a.paddingSM}px ${a.padding}px`,headerBg:a.colorFillAlter,contentPadding:`${a.padding}px 16px`,contentBg:a.colorBgContainer,borderlessContentPadding:`${a.paddingXXS}px 16px ${a.padding}px`,borderlessContentBg:"transparent"}),Ve=Se("Collapse",a=>{const e=ve(a,{collapseHeaderPaddingSM:`${P(a.paddingXS)} ${P(a.paddingSM)}`,collapseHeaderPaddingLG:`${P(a.padding)} ${P(a.paddingLG)}`,collapsePanelBorderRadius:a.borderRadiusLG});return[We(e),Xe(e),Ue(e),qe(e),je(e)]},Qe),Je=w.forwardRef((a,e)=>{const{getPrefixCls:t,direction:o,expandIcon:n,className:i,style:y,classNames:m,styles:l}=xe("collapse"),{prefixCls:d,className:p,rootClassName:f,style:$,bordered:s=!0,ghost:c,size:v,expandIconPlacement:T,expandIconPosition:j,children:u,destroyInactivePanel:I,destroyOnHidden:C,expandIcon:N,classNames:S,styles:x}=a,b=Ne(M=>v??M??"middle"),g=t("collapse",d),B=t(),[A,k]=Ve(g),R=T??j??"start",Y={...a,size:b,bordered:s,expandIconPlacement:R},[D,q]=Te([m,S],[l,x],{props:Y}),F=N??n,se=w.useCallback((M={})=>{const L=typeof F=="function"?F(M):w.createElement(Ie,{rotate:M.isActive?o==="rtl"?-90:90:void 0,"aria-label":M.isActive?"expanded":"collapsed"});return Pe(L,()=>{var X;return{className:E((X=L==null?void 0:L.props)==null?void 0:X.className,`${g}-arrow`)}})},[F,g,o]),le=E(`${g}-icon-placement-${R}`,{[`${g}-borderless`]:!s,[`${g}-rtl`]:o==="rtl",[`${g}-ghost`]:!!c,[`${g}-${b}`]:b!=="middle"},i,p,f,A,k,D.root),ie=w.useMemo(()=>({...we(B),motionAppear:!1,leavedClassName:`${g}-panel-hidden`}),[B,g]),ce=w.useMemo(()=>u?te(u).map(M=>M):null,[u]);return w.createElement(W,{ref:e,openMotion:ie,...Ee(a,["rootClassName"]),expandIcon:se,prefixCls:g,className:le,style:{...q.root,...y,...$},classNames:D,styles:q,destroyOnHidden:C??I},ce)}),oe=Object.assign(Je,{Panel:Ze}),{Title:_a,Text:_}=Oe,{Panel:ea}=oe,Z=[{value:"asset",label:"Assets",color:"blue"},{value:"liability",label:"Liabilities",color:"red"},{value:"equity",label:"Equity",color:"purple"},{value:"revenue",label:"Revenue",color:"green"},{value:"expense",label:"Expenses",color:"orange"}];function Ma({trialBalanceData:a,groupedData:e,totals:t,filters:o}){const{token:n}=be.useToken(),[i,y]=w.useState(o.as_of_date?H(o.as_of_date):H()),[m,l]=w.useState(o.account_type||null),d=()=>{U.get("/admin-portal/trial-balance",{as_of_date:i.format("YYYY-MM-DD"),account_type:m},{preserveState:!0,preserveScroll:!0})},p=()=>{y(H()),l(null),U.get("/admin-portal/trial-balance",{as_of_date:H().format("YYYY-MM-DD")},{preserveState:!0,preserveScroll:!0})},f=()=>{console.log("Export trial balance")},$=[{title:"Account Code",dataIndex:"account_code",key:"account_code",width:120},{title:"Account Name",dataIndex:"account_name",key:"account_name",ellipsis:!0},{title:"Type",dataIndex:"account_type",key:"account_type",width:120,render:s=>{const c=Z.find(v=>v.value===s);return r.jsx(ee,{color:c==null?void 0:c.color,children:c==null?void 0:c.label.toUpperCase()})}},{title:"Debit Balance",dataIndex:"debit_balance",key:"debit_balance",width:150,align:"right",render:s=>s>0?`TZS ${parseFloat(s).toLocaleString()}`:"-"},{title:"Credit Balance",dataIndex:"credit_balance",key:"credit_balance",width:150,align:"right",render:s=>s>0?`TZS ${parseFloat(s).toLocaleString()}`:"-"}];return r.jsxs(r.Fragment,{children:[r.jsx(he,{title:"Trial Balance - Tabata Welfare Association"}),r.jsx(Ae,{children:r.jsxs(z,{children:[t&&r.jsx(Be,{message:t.is_balanced?"Books are Balanced":"Books are Out of Balance",description:t.is_balanced?"Total debits equal total credits. Your accounting records are balanced.":`There is a difference of TZS ${parseFloat(t.difference).toLocaleString()} between debits and credits. Please review your journal entries.`,type:t.is_balanced?"success":"error",icon:t.is_balanced?r.jsx(Re,{}):r.jsx(_e,{}),showIcon:!0,style:{marginBottom:16}}),r.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[r.jsxs(V,{wrap:!0,children:[r.jsx(Me,{placeholder:"As of Date",value:i,onChange:y,style:{width:160}}),r.jsx(J,{placeholder:"Account Type",value:m,onChange:l,style:{width:150},allowClear:!0,children:Z.map(s=>r.jsx(J.Option,{value:s.value,children:s.label},s.value))}),r.jsx(G,{onClick:d,type:"primary",icon:r.jsx(ke,{}),children:"Generate"}),r.jsx(G,{onClick:p,children:"Reset"})]}),r.jsx(G,{icon:r.jsx(He,{}),onClick:f,children:"Export"})]}),r.jsxs("div",{style:{marginBottom:16,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[r.jsxs(z,{size:"small",style:{backgroundColor:n.colorPrimaryBg},children:[r.jsx(_,{type:"secondary",children:"Total Debits"}),r.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",marginTop:"8px",color:n.colorPrimary},children:["TZS ",parseFloat(t.total_debits).toLocaleString()]})]}),r.jsxs(z,{size:"small",style:{backgroundColor:n.colorPrimaryBg},children:[r.jsx(_,{type:"secondary",children:"Total Credits"}),r.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",marginTop:"8px",color:n.colorPrimary},children:["TZS ",parseFloat(t.total_credits).toLocaleString()]})]}),r.jsxs(z,{size:"small",style:{backgroundColor:t.is_balanced?n.colorSuccessBg:n.colorErrorBg},children:[r.jsx(_,{type:"secondary",children:"Difference"}),r.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",marginTop:"8px",color:t.is_balanced?n.colorSuccess:n.colorError},children:["TZS ",parseFloat(t.difference).toLocaleString()]})]})]}),!m&&Object.keys(e).length>0&&r.jsx(oe,{defaultActiveKey:Object.keys(e),style:{marginBottom:16},children:Z.map(s=>{const c=e[s.value]||[];if(c.length===0)return null;const v=c.reduce((j,u)=>j+parseFloat(u.debit_balance),0),T=c.reduce((j,u)=>j+parseFloat(u.credit_balance),0);return r.jsx(ea,{header:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("span",{children:[r.jsx(ee,{color:s.color,children:s.label.toUpperCase()}),r.jsxs(_,{type:"secondary",children:["(",c.length," accounts)"]})]}),r.jsxs(V,{children:[r.jsxs(_,{children:["Debits: TZS ",v.toLocaleString()]}),r.jsxs(_,{children:["Credits: TZS ",T.toLocaleString()]})]})]}),children:r.jsx(O,{columns:$,dataSource:c,rowKey:"id",pagination:!1,size:"small",bordered:!0})},s.value)})}),r.jsx(O,{columns:$,dataSource:a,rowKey:"id",pagination:!1,size:"small",bordered:!0,scroll:{x:800},summary:()=>r.jsxs(O.Summary.Row,{style:{backgroundColor:n.colorPrimaryBg},children:[r.jsx(O.Summary.Cell,{index:0,colSpan:3,children:r.jsx("strong",{style:{fontSize:"16px"},children:"TOTAL"})}),r.jsx(O.Summary.Cell,{index:1,align:"right",children:r.jsxs("strong",{style:{fontSize:"16px",color:n.colorPrimary},children:["TZS ",parseFloat(t.total_debits).toLocaleString()]})}),r.jsx(O.Summary.Cell,{index:2,align:"right",children:r.jsxs("strong",{style:{fontSize:"16px",color:n.colorPrimary},children:["TZS ",parseFloat(t.total_credits).toLocaleString()]})})]})}),r.jsxs("div",{style:{marginTop:16,textAlign:"center"},children:[r.jsxs(_,{type:"secondary",children:["Trial Balance as of ",H(o.as_of_date).format("MMMM DD, YYYY")]}),r.jsx("br",{}),r.jsxs(_,{type:"secondary",style:{fontSize:"12px"},children:["Generated on ",H().format("MMMM DD, YYYY HH:mm")]})]})]})})]})}export{Ma as default};
