var C=Object.defineProperty;var T=(n,t,e)=>t in n?C(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var E=(n,t,e)=>T(n,typeof t!="symbol"?t+"":t,e);import{C as x,r as d}from"./app-BCoYgWpy.js";const h="add",k="keep",A="remove",S="removed";function L(n){let t;return n&&typeof n=="object"&&"key"in n?t=n:t={key:n},{...t,key:String(t.key)}}function K(n=[]){return n.map(L)}function P(n=[],t=[]){let e=[],r=0;const v=t.length,u=K(n),i=K(t);u.forEach(s=>{let o=!1;for(let a=r;a<v;a+=1){const m=i[a];if(m.key===s.key){r<a&&(e=e.concat(i.slice(r,a).map(l=>({...l,status:h}))),r=a),e.push({...m,status:k}),r+=1,o=!0;break}}o||e.push({...s,status:A})}),r<v&&(e=e.concat(i.slice(r).map(s=>({...s,status:h}))));const p={};return e.forEach(({key:s})=>{p[s]=(p[s]||0)+1}),Object.keys(p).filter(s=>p[s]>1).forEach(s=>{e=e.filter(({key:o,status:a})=>o!==s||a!==A),e.forEach(o=>{o.key===s&&(o.status=k)})}),e}function O(){return O=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},O.apply(this,arguments)}const M=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function _(n,t=x){class e extends d.Component{constructor(){super(...arguments);E(this,"state",{keyEntities:[]});E(this,"removeKey",u=>{this.setState(i=>({keyEntities:i.keyEntities.map(c=>c.key!==u?c:{...c,status:S})}),()=>{const{keyEntities:i}=this.state;i.filter(({status:c})=>c!==S).length===0&&this.props.onAllRemoved&&this.props.onAllRemoved()})})}static getDerivedStateFromProps({keys:u},{keyEntities:i}){const p=K(u);return{keyEntities:P(i,p).filter(s=>{const o=i.find(({key:a})=>s.key===a);return!(o&&o.status===S&&s.status===A)})}}render(){const{keyEntities:u}=this.state,{component:i,children:p,onVisibleChanged:c,onAllRemoved:s,...o}=this.props,a=i||d.Fragment,m={};return M.forEach(l=>{m[l]=o[l],delete o[l]}),delete o.keys,d.createElement(a,o,u.map(({status:l,...f},b)=>{const g=l===h||l===k;return d.createElement(t,O({},m,{key:f.key,visible:g,eventProps:f,onVisibleChanged:y=>{c==null||c(y,{key:f.key}),y||this.removeKey(f.key)}}),(y,j)=>p({...y,index:b},j))}))}}return E(e,"defaultProps",{component:"div"}),e}const N=_();export{N as C};
