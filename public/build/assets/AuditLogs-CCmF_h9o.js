import{t as B,r as a,j as t,Q,S as n}from"./app-Cfy4TXUM.js";import{A as G,S as i,B as m,T as d,k as K}from"./AdminSidebarLayout-Buj-taLG.js";import{d as c}from"./dayjs.min-CQ88ldzR.js";import{C as N}from"./index-mG9EyX9P.js";import{I as V}from"./index-BWhN2zcf.js";import{R as W}from"./useIcons-C0CVJH8d.js";import{S as r}from"./index-BH-hJvoT.js";import{D as Y}from"./index-B7DGN-AY.js";import{F as q}from"./Table-BDJDT3yO.js";import{E as k}from"./index-BqBQ4c5d.js";import{T as h}from"./index-eYiOuDe6.js";import{R as J}from"./GlobalOutlined-ClzCwejk.js";import{R as X}from"./EyeOutlined-c0yod4UM.js";import{T as Z}from"./index-BAjCEJt5.js";import"./SessionTimeout-Dn5jdFb_.js";import"./Modal-dSY3wv-x.js";import"./transition-CwSGfga5.js";import"./PrimaryButton-D3tyYlDf.js";import"./SecondaryButton-HhmXi8wu.js";import"./Input-CfZxHJYv.js";import"./getAllowClear-CEhEtxYT.js";import"./TextArea-kKKIj_tr.js";import"./DownOutlined-D7IvzF20.js";import"./CalendarOutlined-Dc2SfXVk.js";import"./ClockCircleOutlined-BEpyFDSv.js";import"./useForm-WxDJKNk0.js";import"./scrollTo-CLqcVzDY.js";import"./index-Du1U9e5C.js";import"./EditOutlined-DIT7bWP5.js";const{Text:Me}=Z;function Ye({logs:s,users:A,actions:R,categories:E,modelTypes:b,filters:o}){B.useToken();const[x,y]=a.useState(o.search||""),[S,g]=a.useState(o.user_id||null),[j,f]=a.useState(o.action||null),[v,w]=a.useState(o.category||null),[C,_]=a.useState(o.severity||null),[T,z]=a.useState(o.model_type||null),[p,D]=a.useState(o.date_from?c(o.date_from):null),[u,I]=a.useState(o.date_to?c(o.date_to):null),M=()=>{n.get("/admin-portal/audit-logs",{search:x,user_id:S,action:j,category:v,severity:C,model_type:T,date_from:p?p.format("YYYY-MM-DD"):null,date_to:u?u.format("YYYY-MM-DD"):null},{preserveState:!0,preserveScroll:!0})},O=()=>{y(""),g(null),f(null),w(null),_(null),z(null),D(null),I(null),n.get("/admin-portal/audit-logs",{},{preserveState:!0,preserveScroll:!0})},F=e=>{n.visit(route("admin-portal.audit-logs.show",e.id))},U=e=>({low:"green",medium:"blue",high:"orange",critical:"red"})[e]||"default",L=e=>({auth:"purple",member:"blue",financial:"green",system:"orange",security:"red",general:"default"})[e]||"default",P=e=>({created:"green",updated:"blue",deleted:"red",viewed:"cyan",login:"purple",logout:"purple",posted:"green",reversed:"orange"})[e.toLowerCase()]||"default",H=[{title:"Date & Time",dataIndex:"created_at",key:"created_at",width:150,render:e=>t.jsx(d,{title:c(e).format("YYYY-MM-DD HH:mm:ss"),children:t.jsx("span",{style:{fontSize:"13px"},children:c(e).format("MMM DD, YYYY HH:mm")})})},{title:"User",dataIndex:"user_name",key:"user_name",width:140,ellipsis:!0,render:(e,l)=>t.jsx(d,{title:l.user_email,children:t.jsxs(i,{size:"small",children:[t.jsx(K,{style:{fontSize:"12px"}}),t.jsx("span",{style:{fontSize:"13px"},children:e||"System"})]})})},{title:"Action",dataIndex:"action",key:"action",width:110,render:e=>t.jsx(h,{color:P(e),style:{fontSize:"11px"},children:e.toUpperCase()})},{title:"Category",dataIndex:"category",key:"category",width:100,render:e=>e?t.jsx(h,{color:L(e),style:{fontSize:"11px"},children:e.toUpperCase()}):t.jsx("span",{style:{fontSize:"13px"},children:"-"})},{title:"Model",dataIndex:"model_type",key:"model_type",width:120,ellipsis:!0,render:(e,l)=>e?t.jsx(d,{title:`${e} (ID: ${l.model_id})`,children:t.jsx("span",{style:{fontSize:"13px"},children:l.model_name||$(e)})}):t.jsx("span",{style:{fontSize:"13px"},children:"-"})},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0,render:e=>t.jsx("span",{style:{fontSize:"13px"},children:e||"-"})},{title:"Severity",dataIndex:"severity",key:"severity",width:90,render:e=>t.jsx(h,{color:U(e),style:{fontSize:"11px"},children:e.toUpperCase()})},{title:"IP Address",dataIndex:"ip_address",key:"ip_address",width:120,render:e=>e?t.jsx(d,{title:e,children:t.jsxs(i,{size:"small",children:[t.jsx(J,{style:{fontSize:"12px"}}),t.jsx("span",{style:{fontSize:"12px"},children:e})]})}):t.jsx("span",{style:{fontSize:"13px"},children:"-"})},{title:"Actions",key:"actions",width:70,fixed:"right",render:(e,l)=>t.jsx(m,{type:"text",size:"small",icon:t.jsx(X,{}),onClick:()=>F(l)})}],$=e=>{if(!e)return"";const l=e.split("\\");return l[l.length-1]};return t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:"Audit Logs - Tabata Welfare Association"}),t.jsx(G,{children:t.jsxs(N,{children:[t.jsxs("div",{style:{marginBottom:16},children:[t.jsxs(i,{wrap:!0,style:{marginBottom:12},children:[t.jsx(V,{placeholder:"Search logs...",prefix:t.jsx(W,{}),value:x,onChange:e=>y(e.target.value),onPressEnter:M,style:{width:200},allowClear:!0}),t.jsx(r,{placeholder:"User",value:S,onChange:g,style:{width:180},allowClear:!0,showSearch:!0,optionFilterProp:"children",children:A.map(e=>t.jsx(r.Option,{value:e.id,children:e.name},e.id))}),t.jsx(r,{placeholder:"Action",value:j,onChange:f,style:{width:130},allowClear:!0,children:R.map(e=>t.jsx(r.Option,{value:e,children:e},e))}),t.jsx(r,{placeholder:"Category",value:v,onChange:w,style:{width:130},allowClear:!0,children:E.map(e=>t.jsx(r.Option,{value:e,children:e},e))}),t.jsxs(r,{placeholder:"Severity",value:C,onChange:_,style:{width:120},allowClear:!0,children:[t.jsx(r.Option,{value:"low",children:"Low"}),t.jsx(r.Option,{value:"medium",children:"Medium"}),t.jsx(r.Option,{value:"high",children:"High"}),t.jsx(r.Option,{value:"critical",children:"Critical"})]})]}),t.jsxs(i,{wrap:!0,children:[t.jsx(r,{placeholder:"Model Type",value:T,onChange:z,style:{width:150},allowClear:!0,children:b.map(e=>t.jsx(r.Option,{value:e.value,children:e.label},e.value))}),t.jsx(Y,{placeholder:"From Date",value:p,onChange:D,style:{width:140}}),t.jsx(Y,{placeholder:"To Date",value:u,onChange:I,style:{width:140}}),t.jsx(m,{onClick:M,type:"primary",children:"Search"}),t.jsx(m,{onClick:O,children:"Reset"})]})]}),t.jsx(q,{columns:H,dataSource:s.data,rowKey:"id",size:"small",pagination:{current:s.current_page,pageSize:s.per_page,total:s.total,showSizeChanger:!1,showTotal:e=>t.jsxs("span",{style:{fontSize:"13px"},children:["Total ",e," logs"]}),onChange:e=>{n.get("/admin-portal/audit-logs",{...o,page:e},{preserveState:!0,preserveScroll:!0})}},locale:{emptyText:t.jsx(k,{description:"No audit logs found",image:k.PRESENTED_IMAGE_SIMPLE})},scroll:{x:1300}})]})})]})}export{Ye as default};
