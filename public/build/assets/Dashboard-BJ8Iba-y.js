import{r as h,J as W,a as Z,R as E,j as e}from"./app-CCWscn4N.js";import{I as M,A as G,C as a,p as K,n as q,S as Q}from"./AdminSidebarLayout-BHFbP-0Z.js";import{B as X,D as ee,C as te,a as re,b as ne,c as oe,p as se,f as ae,g as ie,A as le}from"./index-Bay9h-2m.js";import{A as ce}from"./index-CijJxMn4.js";import{R as x,C as i}from"./row-BLaRi8TG.js";import{S as d}from"./index-DyamrY43.js";import{R as I,a as R}from"./RiseOutlined-DouyyTcP.js";import{R as T}from"./ExclamationCircleOutlined-CTyvqMsv.js";import{S as me}from"./index-C-HA1eIq.js";import{F as D}from"./Table-DUVIRzZL.js";import{E as p}from"./index-CdwOtgdH.js";import{T as de}from"./index-iEk3Z0oW.js";import{T as A}from"./index-CCn2kg36.js";import"./SessionTimeout-72mUHhjZ.js";import"./Modal-CTkSowC8.js";import"./transition-BcOJrHw_.js";import"./PrimaryButton-0XQdD5oU.js";import"./SecondaryButton-DbLXN_Wj.js";import"./CheckCircleFilled-B-8ZM7Vi.js";import"./InfoCircleFilled-BBeUonew.js";import"./useIcons-Bh5YfX0K.js";import"./getAllowClear-ggc3xdDv.js";import"./DownOutlined-B9GtLQuW.js";import"./useForm-CpR6UdBL.js";import"./index-5hnhc-Y9.js";import"./Input-Br3Lt1rS.js";import"./EditOutlined-BgapihRa.js";import"./TextArea-n8YGhIra.js";var ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M894 462c30.9 0 43.8-39.7 18.7-58L530.8 126.2a31.81 31.81 0 00-37.6 0L111.3 404c-25.1 18.2-12.2 58 18.8 58H192v374h-72c-4.4 0-8 3.6-8 8v52c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-52c0-4.4-3.6-8-8-8h-72V462h62zM512 196.7l271.1 197.2H240.9L512 196.7zM264 462h117v374H264V462zm189 0h117v374H453V462zm307 374H642V462h118v374z"}}]},name:"bank",theme:"outlined"};function j(){return j=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var m in c)Object.prototype.hasOwnProperty.call(c,m)&&(n[m]=c[m])}return n},j.apply(this,arguments)}const pe=(n,o)=>h.createElement(M,j({},n,{ref:o,icon:ue})),xe=h.forwardRef(pe);var he={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"};function y(){return y=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var m in c)Object.prototype.hasOwnProperty.call(c,m)&&(n[m]=c[m])}return n},y.apply(this,arguments)}const ge=(n,o)=>h.createElement(M,y({},n,{ref:o,icon:he})),fe=h.forwardRef(ge);te.register(re,ne,oe,se,ae,ie,le);const{Text:je,Title:Qe}=de,l=n=>new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS",minimumFractionDigits:0,maximumFractionDigits:0}).format(n);function Xe(){const{memberCount:n=0,contributionSum:o=0,disasterPaymentSum:c=0,debtSum:m=0,activeMembers:g=0,monthlyContributions:k=[],recentContributions:B=[],recentDisasterPayments:$=[],accountingSummary:z={},accountBalances:ye={},topAccounts:be=[]}=W().props,{cash_balance:b=0,total_revenue:O=0,total_expenses:P=0,net_income:u=0,recent_entries:F=[],entries_count_today:ve=0,entries_count_month:Se=0}=z,{token:s}=Z.useToken(),[v,L]=E.useState(new Date().getFullYear()),S=new Date().getFullYear(),N=E.useMemo(()=>{const t=[];for(let r=S;r>=2018;r--)t.push({label:r.toString(),value:r});return t},[S]),w=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((t,r)=>{const C=k.find(U=>{const _=new Date(U.month+"-01");return _.getMonth()===r&&_.getFullYear()===v});return{month:t,amount:C?C.total:0}}),V={labels:w.map(t=>t.month),datasets:[{label:"Monthly Contributions",data:w.map(t=>t.amount),backgroundColor:s.colorPrimary,borderColor:s.colorPrimary,borderRadius:4,borderWidth:2}]},H={labels:["Active","Inactive"],datasets:[{data:[g,n-g],backgroundColor:[s.colorSuccess,s.colorTextSecondary],borderColor:s.colorBgContainer,borderWidth:2}]},f=[...B.map(t=>{var r;return{id:`contribution-${t.id}`,description:`Contribution of ${l(t.amount)} from ${((r=t.member)==null?void 0:r.name)||"Unknown"}`,type:"contribution",created_at:t.date}}),...$.map(t=>{var r;return{id:`disaster-${t.id}`,description:`Disaster payment of ${l(t.amount)} to ${((r=t.member)==null?void 0:r.name)||"Unknown"}`,type:"disaster",created_at:t.date}})].sort((t,r)=>new Date(r.created_at)-new Date(t.created_at)).slice(0,5),J=[{title:"Entry #",dataIndex:"entry_number",key:"entry_number",width:120,render:t=>e.jsx(je,{code:!0,style:{fontSize:"11px"},children:t})},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0,render:t=>e.jsx("span",{style:{fontSize:"12px"},children:t})},{title:"Amount",dataIndex:"total_debit",key:"amount",width:100,align:"right",render:t=>e.jsx("span",{style:{fontSize:"12px"},children:l(t)})},{title:"Status",dataIndex:"status",key:"status",width:80,render:t=>e.jsx(A,{color:t==="posted"?"green":t==="draft"?"orange":"red",style:{fontSize:"10px"},children:t.toUpperCase()})}],Y=[{title:"Activity",dataIndex:"description",key:"description",width:"50%"},{title:"Type",dataIndex:"type",key:"type",width:"25%",render:t=>{const r={member:"blue",contribution:"green",penalty:"red",disaster:"orange",system:"default"};return e.jsx(A,{color:r[t]||"default",children:t})}},{title:"Date",dataIndex:"created_at",key:"created_at",width:"25%",render:t=>new Date(t).toLocaleDateString()}];return e.jsxs(G,{children:[u<0&&e.jsx(ce,{message:"Financial Alert",description:`Net income is negative (${l(u)}). Review expenses and revenue streams.`,type:"warning",showIcon:!0,closable:!0,style:{marginBottom:24}}),e.jsxs(x,{gutter:16,style:{marginBottom:24},children:[e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Total Members",value:n,prefix:e.jsx(K,{}),suffix:`(${g} active)`})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Cash Balance",value:b,prefix:e.jsx(xe,{}),formatter:t=>l(t),valueStyle:{color:b>=0?s.colorSuccess:s.colorError}})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Total Revenue",value:O,prefix:e.jsx(I,{}),formatter:t=>l(t),valueStyle:{color:s.colorSuccess}})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Net Income",value:u,prefix:u>=0?e.jsx(I,{}):e.jsx(R,{}),formatter:t=>l(t),valueStyle:{color:u>=0?s.colorSuccess:s.colorError}})})})]}),e.jsxs(x,{gutter:16,style:{marginBottom:24},children:[e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Total Contributions",value:o,prefix:e.jsx(q,{}),formatter:t=>l(t)})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Total Expenses",value:P,prefix:e.jsx(R,{}),formatter:t=>l(t),valueStyle:{color:s.colorError}})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Disaster Payments",value:c,prefix:e.jsx(T,{}),formatter:t=>l(t)})})}),e.jsx(i,{xs:24,sm:12,lg:6,children:e.jsx(a,{children:e.jsx(d,{title:"Outstanding Debts",value:m,prefix:e.jsx(T,{}),formatter:t=>l(t),valueStyle:{color:s.colorWarning}})})})]}),e.jsxs(x,{gutter:16,style:{marginBottom:24},children:[e.jsx(i,{xs:24,lg:12,children:e.jsx(a,{title:"Monthly Contributions Trend",extra:e.jsx(me,{value:v,onChange:L,options:N,style:{width:100}}),children:e.jsx(X,{data:V,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,ticks:{callback:function(t){return l(t)}}}}}})})}),e.jsx(i,{xs:24,lg:12,children:e.jsx(a,{title:"Member Status",children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px"},children:e.jsx("div",{style:{width:"160px",height:"160px"},children:e.jsx(ee,{data:H,options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"bottom"}}}})})})})})]}),e.jsxs(x,{gutter:16,children:[e.jsx(i,{xs:24,lg:12,children:e.jsx(a,{title:e.jsxs(Q,{children:[e.jsx(fe,{}),"Recent Journal Entries"]}),size:"small",children:e.jsx(D,{columns:J,dataSource:F,rowKey:"id",size:"small",pagination:!1,locale:{emptyText:e.jsx(p,{description:"No recent journal entries",image:p.PRESENTED_IMAGE_SIMPLE})}})})}),e.jsx(i,{xs:24,lg:12,children:e.jsx(a,{title:"Recent Activities",children:f&&f.length>0?e.jsx(D,{columns:Y,dataSource:f,rowKey:"id",pagination:!1,size:"small",locale:{emptyText:e.jsx(p,{description:"No recent activities",image:p.PRESENTED_IMAGE_SIMPLE})}}):e.jsx(p,{description:"No recent activities"})})})]})]})}export{Xe as default};
