import{a as R,r as E,j as e,S as D}from"./app-CCWscn4N.js";import{A as k,S as A,B,C as x}from"./AdminSidebarLayout-BHFbP-0Z.js";import{d as c}from"./dayjs.min-Be2yCFt4.js";import{D as b}from"./index-D2nthcHU.js";import{R as P}from"./DownloadOutlined-DAAaMqUK.js";import{T as $}from"./index-iEk3Z0oW.js";import{R as Z,a as I}from"./RiseOutlined-DouyyTcP.js";import{P as v}from"./progress-KqQtMOrv.js";import{R as h,C as n}from"./row-BLaRi8TG.js";import"./SessionTimeout-72mUHhjZ.js";import"./Modal-CTkSowC8.js";import"./transition-BcOJrHw_.js";import"./PrimaryButton-0XQdD5oU.js";import"./SecondaryButton-DbLXN_Wj.js";import"./useIcons-Bh5YfX0K.js";import"./getAllowClear-ggc3xdDv.js";import"./DownOutlined-B9GtLQuW.js";import"./CalendarOutlined-eixNbCoN.js";import"./ClockCircleOutlined-BGBypZha.js";import"./EditOutlined-BgapihRa.js";import"./TextArea-n8YGhIra.js";import"./CheckCircleFilled-B-8ZM7Vi.js";const{Title:_,Text:o}=$;function pe({revenue:z,expenses:j,groupedRevenue:O,groupedExpenses:w,totals:t,filters:p}){const{token:r}=R.useToken(),[f,C]=E.useState(p.date_from?c(p.date_from):c().startOf("year")),[S,F]=E.useState(p.date_to?c(p.date_to):c()),L=()=>{D.get("/admin-portal/income-statement",{date_from:f.format("YYYY-MM-DD"),date_to:S.format("YYYY-MM-DD")},{preserveState:!0,preserveScroll:!0})},Y=()=>{console.log("Export income statement")},u=(a,d,T=!1)=>{if(!d||d.length===0)return null;const M=d.reduce((s,i)=>{const m=i.account_subtype||"Other";return s[m]||(s[m]=[]),s[m].push(i),s},{});return d.reduce((s,i)=>s+parseFloat(i.balance),0),e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(_,{level:5,style:{marginBottom:16,color:T?r.colorSuccess:r.colorError,borderBottom:`2px solid ${T?r.colorSuccess:r.colorError}`,paddingBottom:8},children:a}),Object.entries(M).map(([s,i])=>{const m=i.reduce((g,y)=>g+parseFloat(y.balance),0);return e.jsxs("div",{style:{marginBottom:16},children:[i.length>1&&e.jsx("div",{style:{fontWeight:"bold",marginBottom:8,color:r.colorTextSecondary},children:s}),i.map(g=>{var y;return e.jsxs(h,{style:{marginBottom:4,paddingLeft:i.length>1?16:0},children:[e.jsx(n,{span:14,children:e.jsx(o,{children:g.account_name})}),e.jsx(n,{span:6,style:{textAlign:"right"},children:e.jsxs(o,{children:["TZS ",parseFloat(g.balance).toLocaleString()]})}),e.jsx(n,{span:4,style:{textAlign:"right",paddingLeft:8},children:e.jsxs(o,{type:"secondary",style:{fontSize:"12px"},children:[(y=g.percentage)==null?void 0:y.toFixed(1),"%"]})})]},g.id)}),i.length>1&&e.jsxs(h,{style:{marginTop:8,paddingLeft:16,borderTop:`1px solid ${r.colorBorder}`,paddingTop:4},children:[e.jsx(n,{span:14,children:e.jsxs(o,{strong:!0,children:["Total ",s]})}),e.jsx(n,{span:6,style:{textAlign:"right"},children:e.jsxs(o,{strong:!0,children:["TZS ",m.toLocaleString()]})}),e.jsx(n,{span:4})]})]},s)})]})},l=t.net_income>=0;return e.jsxs(k,{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[e.jsxs(A,{children:[e.jsx(b,{placeholder:"From Date",value:f,onChange:C,style:{width:140}}),e.jsx(b,{placeholder:"To Date",value:S,onChange:F,style:{width:140}}),e.jsx(B,{onClick:L,type:"primary",children:"Generate Report"})]}),e.jsx(B,{icon:e.jsx(P,{}),onClick:Y,children:"Export"})]}),e.jsxs("div",{style:{marginBottom:24,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[e.jsxs(x,{size:"small",style:{backgroundColor:r.colorSuccessBg},children:[e.jsx(o,{type:"secondary",children:"Total Revenue"}),e.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",marginTop:"8px",color:r.colorSuccess},children:["TZS ",parseFloat(t.total_revenue).toLocaleString()]})]}),e.jsxs(x,{size:"small",style:{backgroundColor:r.colorErrorBg},children:[e.jsx(o,{type:"secondary",children:"Total Expenses"}),e.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",marginTop:"8px",color:r.colorError},children:["TZS ",parseFloat(t.total_expenses).toLocaleString()]})]}),e.jsxs(x,{size:"small",style:{backgroundColor:l?r.colorSuccessBg:r.colorErrorBg},children:[e.jsx(o,{type:"secondary",children:"Net Income"}),e.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",marginTop:"8px",color:l?r.colorSuccess:r.colorError,display:"flex",alignItems:"center",gap:"8px"},children:[l?e.jsx(Z,{}):e.jsx(I,{}),"TZS ",parseFloat(t.net_income).toLocaleString()]})]}),e.jsxs(x,{size:"small",style:{backgroundColor:r.colorPrimaryBg},children:[e.jsx(o,{type:"secondary",children:"Profit Margin"}),e.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",marginTop:"8px",color:r.colorPrimary},children:[t.profit_margin.toFixed(1),"%"]}),e.jsx(v,{percent:Math.abs(t.profit_margin),showInfo:!1,strokeColor:l?r.colorSuccess:r.colorError,size:"small",style:{marginTop:8}})]})]}),e.jsxs("div",{style:{padding:24,backgroundColor:r.colorBgContainer,border:`1px solid ${r.colorBorder}`,borderRadius:8},children:[e.jsx("div",{style:{textAlign:"center",marginBottom:32},children:e.jsxs(o,{type:"secondary",children:["For the Period: ",c(p.date_from).format("MMM DD, YYYY")," to ",c(p.date_to).format("MMM DD, YYYY")]})}),u("REVENUE",z,!0),e.jsxs(h,{style:{marginBottom:32,paddingTop:12,borderTop:`2px solid ${r.colorSuccess}`,paddingBottom:12},children:[e.jsx(n,{span:14,children:e.jsx(o,{strong:!0,style:{fontSize:16},children:"TOTAL REVENUE"})}),e.jsx(n,{span:6,style:{textAlign:"right"},children:e.jsxs(o,{strong:!0,style:{fontSize:16,color:r.colorSuccess},children:["TZS ",parseFloat(t.total_revenue).toLocaleString()]})}),e.jsx(n,{span:4,style:{textAlign:"right"},children:e.jsx(o,{strong:!0,style:{fontSize:14},children:"100%"})})]}),u("EXPENSES",j,!1),e.jsxs(h,{style:{marginBottom:24,paddingTop:12,borderTop:`2px solid ${r.colorError}`,paddingBottom:12},children:[e.jsx(n,{span:14,children:e.jsx(o,{strong:!0,style:{fontSize:16},children:"TOTAL EXPENSES"})}),e.jsx(n,{span:6,style:{textAlign:"right"},children:e.jsxs(o,{strong:!0,style:{fontSize:16,color:r.colorError},children:["TZS ",parseFloat(t.total_expenses).toLocaleString()]})}),e.jsx(n,{span:4,style:{textAlign:"right"},children:e.jsxs(o,{strong:!0,style:{fontSize:14},children:[t.total_revenue>0?(t.total_expenses/t.total_revenue*100).toFixed(1):0,"%"]})})]}),e.jsxs(h,{style:{marginBottom:24,paddingTop:16,paddingBottom:16,borderTop:`3px double ${r.colorPrimary}`,borderBottom:`3px double ${r.colorPrimary}`,backgroundColor:l?r.colorSuccessBg:r.colorErrorBg,marginLeft:-24,marginRight:-24,paddingLeft:24,paddingRight:24},children:[e.jsx(n,{span:14,children:e.jsx(o,{strong:!0,style:{fontSize:18},children:l?"NET INCOME (PROFIT)":"NET LOSS"})}),e.jsx(n,{span:6,style:{textAlign:"right"},children:e.jsxs(o,{strong:!0,style:{fontSize:18,color:l?r.colorSuccess:r.colorError},children:["TZS ",parseFloat(t.net_income).toLocaleString()]})}),e.jsx(n,{span:4,style:{textAlign:"right"},children:e.jsxs(o,{strong:!0,style:{fontSize:16},children:[t.profit_margin.toFixed(1),"%"]})})]}),e.jsx("div",{style:{textAlign:"center",padding:16,backgroundColor:l?r.colorSuccessBg:r.colorErrorBg,borderRadius:8,marginTop:24},children:e.jsx(o,{strong:!0,style:{fontSize:14},children:l?`✓ Organization generated a profit of TZS ${parseFloat(t.net_income).toLocaleString()} (${t.profit_margin.toFixed(1)}% margin)`:`⚠ Organization incurred a loss of TZS ${parseFloat(Math.abs(t.net_income)).toLocaleString()}`})}),e.jsx("div",{style:{marginTop:32,textAlign:"center",borderTop:`1px solid ${r.colorBorder}`,paddingTop:16},children:e.jsxs(o,{type:"secondary",style:{fontSize:12},children:["Generated on ",c().format("MMMM DD, YYYY HH:mm")]})})]}),j&&j.length>0&&e.jsxs("div",{style:{marginTop:24},children:[e.jsx(_,{level:5,children:"Expense Breakdown"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"12px",marginTop:16},children:j.slice(0,6).map(a=>{var d;return e.jsxs(x,{size:"small",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(o,{strong:!0,children:a.account_name}),e.jsxs(o,{type:"secondary",children:[(d=a.percentage)==null?void 0:d.toFixed(1),"%"]})]}),e.jsx(v,{percent:a.percentage,strokeColor:r.colorError,size:"small"}),e.jsxs(o,{type:"secondary",style:{fontSize:"12px"},children:["TZS ",parseFloat(a.balance).toLocaleString()]})]},a.id)})})]})]})}export{pe as default};
