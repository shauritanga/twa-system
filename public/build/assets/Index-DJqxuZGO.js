import{J as oe,a as re,r as i,x as le,j as e,S as m}from"./app-CCWscn4N.js";import{A as te,C as p,S as q,D as P,B as s,c as ie,bd as se}from"./AdminSidebarLayout-BHFbP-0Z.js";import{d as ne}from"./dayjs.min-Be2yCFt4.js";import{F as t}from"./index-C7rJnUG_.js";import{R as L,C as x}from"./row-BLaRi8TG.js";import{I as n}from"./index-BFcOIicW.js";import{R as ae}from"./useIcons-Bh5YfX0K.js";import{R as W}from"./DownloadOutlined-DAAaMqUK.js";import{R as v}from"./UploadOutlined-Ccf63Knl.js";import{F as ce}from"./Table-DUVIRzZL.js";import{M as I}from"./index-BhSHgn0Z.js";import{S as de}from"./index-C-HA1eIq.js";import{D as me}from"./index-D2nthcHU.js";import{U as B}from"./index-gadxCu6H.js";import{s as a}from"./index-BhyvampS.js";import{T as pe}from"./index-CCn2kg36.js";import{R as xe}from"./MoreOutlined-D2Cbkv-l.js";import{R as he}from"./EyeOutlined-BXjcMdGf.js";import{R as ue}from"./EditOutlined-BgapihRa.js";import{R as fe}from"./DeleteOutlined-S1oeFgow.js";import"./SessionTimeout-72mUHhjZ.js";import"./Modal-CTkSowC8.js";import"./transition-BcOJrHw_.js";import"./PrimaryButton-0XQdD5oU.js";import"./SecondaryButton-DbLXN_Wj.js";import"./CSSMotionList-CEJCmY9t.js";import"./useForm-CpR6UdBL.js";import"./CheckCircleFilled-B-8ZM7Vi.js";import"./InfoCircleFilled-BBeUonew.js";import"./Input-Br3Lt1rS.js";import"./getAllowClear-ggc3xdDv.js";import"./TextArea-n8YGhIra.js";import"./DownOutlined-B9GtLQuW.js";import"./index-5hnhc-Y9.js";import"./index-CdwOtgdH.js";import"./CalendarOutlined-eixNbCoN.js";import"./ClockCircleOutlined-BGBypZha.js";import"./progress-KqQtMOrv.js";function ro(){const{members:c=[],statistics:U={}}=oe().props,{token:o}=re.useToken(),[h]=t.useForm(),[u,$]=i.useState(""),[O,M]=i.useState(!1),[b,C]=i.useState(null),[N,g]=i.useState(!1),[E,_]=i.useState(null),[F,Y]=i.useState(c),[V,S]=i.useState(!1),[H,T]=i.useState(null),[A,j]=i.useState(!1),[X,k]=i.useState(!1),[w,f]=i.useState(null),{reset:D}=le({first_name:"",middle_name:"",surname:"",email:"",phone_number:"",address:"",place_of_birth:"",sex:"Male",date_of_birth:null,tribe:"",occupation:"",reason_for_membership:"",image:null,application_form:null});i.useEffect(()=>{const r=c.filter(l=>l.name.toLowerCase().includes(u.toLowerCase())||l.email.toLowerCase().includes(u.toLowerCase())||l.phone_number&&l.phone_number.includes(u));Y(r)},[u,c]);const R=(r=null)=>{r?(C(r),h.setFieldsValue({first_name:r.first_name,middle_name:r.middle_name,surname:r.surname,email:r.email,phone_number:r.phone_number,address:r.address,place_of_birth:r.place_of_birth,sex:r.sex,date_of_birth:r.date_of_birth?ne(r.date_of_birth):null,tribe:r.tribe,occupation:r.occupation,reason_for_membership:r.reason_for_membership}),r.image_path&&_(`/storage/${r.image_path}`)):(C(null),h.resetFields(),_(null),D()),M(!0)},y=()=>{M(!1),C(null),_(null),h.resetFields(),D()},J=async r=>{var d;g(!0);const l=new FormData;l.append("first_name",r.first_name),l.append("middle_name",r.middle_name||""),l.append("surname",r.surname),l.append("email",r.email),l.append("phone_number",r.phone_number),l.append("address",r.address),l.append("place_of_birth",r.place_of_birth),l.append("sex",r.sex),l.append("date_of_birth",(d=r.date_of_birth)==null?void 0:d.format("YYYY-MM-DD")),l.append("tribe",r.tribe||""),l.append("occupation",r.occupation||""),l.append("reason_for_membership",r.reason_for_membership||""),r.image&&r.image.file&&l.append("image",r.image.file),r.application_form&&r.application_form.file&&l.append("application_form",r.application_form.file);try{b?m.post(route("members.update",b.id),l,{onSuccess:()=>{a.success("Member updated successfully"),y()},onError:()=>{a.error("Failed to update member")},onFinish:()=>g(!1)}):m.post(route("members.store"),l,{onSuccess:()=>{a.success("Member created successfully"),y()},onError:()=>{a.error("Failed to create member")},onFinish:()=>g(!1)})}catch{a.error("An error occurred"),g(!1)}},K=r=>{m.delete(route("members.destroy",r),{onSuccess:()=>{a.success("Member archived successfully"),S(!1),T(null)},onError:()=>{a.error("Failed to archive member")}})},G=r=>{T(r),S(!0)},Q=()=>{k(!0)},Z=()=>{if(!w)return;j(!0);const r=new FormData;r.append("file",w),m.post(route("members.import"),r,{onSuccess:()=>{a.success("Members imported successfully"),k(!1),f(null),j(!1)},onError:l=>{a.error(l.file||"Failed to import members"),j(!1)},onFinish:()=>j(!1)})},z=()=>{k(!1),f(null)},ee=[{title:"Member",dataIndex:"name",key:"name",width:200,render:(r,l)=>e.jsxs(q,{children:[e.jsx(se,{size:"large",src:l.image_path?`/storage/${l.image_path}`:void 0,style:{backgroundColor:o.colorPrimary},children:r.split(" ").map(d=>d[0]).join("").toUpperCase()}),e.jsx("div",{children:e.jsx("div",{style:{fontWeight:"bold"},children:r})})]})},{title:"Email",dataIndex:"email",key:"email",width:180},{title:"Phone",dataIndex:"phone_number",key:"phone_number",width:130},{title:"Address",dataIndex:"address",key:"address",width:150},{title:"DOB",dataIndex:"date_of_birth",key:"date_of_birth",width:110,render:r=>r?new Date(r).toLocaleDateString():"-"},{title:"Status",dataIndex:"is_verified",key:"is_verified",width:100,render:r=>e.jsx(pe,{color:r?"green":"orange",children:r?"Verified":"Pending"})},{title:"Actions",key:"actions",width:80,fixed:"right",render:(r,l)=>{const d=[{key:"view",label:"View",icon:e.jsx(he,{}),onClick:()=>m.visit(route("admin-portal.members.show",l.id))},{key:"edit",label:"Edit",icon:e.jsx(ue,{}),onClick:()=>R(l)},{key:"archive",label:"Archive",icon:e.jsx(fe,{}),danger:!0,onClick:()=>G(l.id)}];return e.jsx(P,{menu:{items:d},trigger:["click"],children:e.jsx(s,{type:"text",icon:e.jsx(xe,{})})})}}];return e.jsx(te,{children:e.jsxs("div",{style:{padding:"24px 0"},children:[e.jsxs(L,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(x,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:o.colorPrimary},children:c.length}),e.jsx("div",{style:{color:o.colorTextSecondary,marginTop:"8px"},children:"Total Members"})]})})}),e.jsx(x,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:o.colorSuccess},children:c.filter(r=>r.is_verified).length}),e.jsx("div",{style:{color:o.colorTextSecondary,marginTop:"8px"},children:"Verified"})]})})}),e.jsx(x,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:o.colorWarning},children:c.filter(r=>!r.is_verified).length}),e.jsx("div",{style:{color:o.colorTextSecondary,marginTop:"8px"},children:"Pending"})]})})}),e.jsx(x,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:o.colorError},children:U.deleted_members||0}),e.jsx("div",{style:{color:o.colorTextSecondary,marginTop:"8px"},children:"Archived"})]})})})]}),e.jsx(p,{style:{marginBottom:"24px"},children:e.jsxs(L,{gutter:[16,16],align:"middle",children:[e.jsx(x,{xs:24,sm:12,md:8,children:e.jsx(n,{placeholder:"Search by name, email, or phone...",prefix:e.jsx(ae,{}),value:u,onChange:r=>$(r.target.value),allowClear:!0})}),e.jsx(x,{xs:24,sm:12,md:16,style:{textAlign:"right"},children:e.jsxs(q,{wrap:!0,children:[e.jsx(P,{menu:{items:[{key:"pdf",label:"Export as PDF",onClick:()=>window.location.href=route("members.export",{format:"pdf"})},{key:"excel",label:"Export as Excel",onClick:()=>window.location.href=route("members.export",{format:"excel"})},{key:"json",label:"Export as JSON",onClick:()=>window.location.href=route("members.export",{format:"json"})}]},trigger:["click"],children:e.jsx(s,{icon:e.jsx(W,{}),children:"Export"})}),e.jsx(s,{onClick:()=>m.visit(route("admin-portal.members.archived")),children:"View Archived"}),e.jsx(s,{icon:e.jsx(v,{}),loading:A,onClick:Q,children:"Import"}),e.jsx(s,{type:"primary",icon:e.jsx(ie,{}),onClick:()=>R(),children:"Add Member"})]})})]})}),e.jsx(p,{children:e.jsx(ce,{columns:ee,dataSource:F,rowKey:"id",pagination:{pageSize:10,total:F.length},scroll:{x:1200},size:"middle"})}),e.jsx(I,{title:b?"Edit Member":"Add New Member",open:O,onCancel:y,width:600,centered:!0,footer:[e.jsx(s,{onClick:y,children:"Cancel"},"cancel"),e.jsx(s,{type:"primary",loading:N,onClick:()=>h.submit(),children:b?"Update Member":"Create Member"},"submit")],styles:{body:{maxHeight:"calc(100vh - 240px)",overflowY:"auto",paddingBottom:"16px"},mask:{backgroundColor:"rgba(0, 0, 0, 0.45)"}},children:e.jsxs(t,{form:h,layout:"vertical",onFinish:J,autoComplete:"off",style:{color:o.colorText},children:[e.jsx(t.Item,{label:"First Name",name:"first_name",rules:[{required:!0,message:"First name is required"}],labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter first name",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Middle Name",name:"middle_name",labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter middle name",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Surname",name:"surname",rules:[{required:!0,message:"Surname is required"}],labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter surname",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Sex",name:"sex",rules:[{required:!0,message:"Sex is required"}],labelCol:{style:{color:o.colorText}},children:e.jsx(de,{options:[{label:"Male",value:"Male"},{label:"Female",value:"Female"}],style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Date of Birth",name:"date_of_birth",rules:[{required:!0,message:"Date of birth is required"}],labelCol:{style:{color:o.colorText}},children:e.jsx(me,{style:{width:"100%",backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Place of Birth",name:"place_of_birth",rules:[{required:!0,message:"Place of birth is required"}],labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter place of birth",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Email is required"},{type:"email",message:"Invalid email format"}],labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter email address",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Phone Number",name:"phone_number",rules:[{required:!0,message:"Phone number is required"}],labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter phone number",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Address",name:"address",rules:[{required:!0,message:"Address is required"}],labelCol:{style:{color:o.colorText}},children:e.jsx(n.TextArea,{placeholder:"Enter address",rows:3,style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Tribe",name:"tribe",labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter tribe",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Occupation",name:"occupation",labelCol:{style:{color:o.colorText}},children:e.jsx(n,{placeholder:"Enter occupation",style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Reason for Membership",name:"reason_for_membership",labelCol:{style:{color:o.colorText}},children:e.jsx(n.TextArea,{placeholder:"Enter reason for membership",rows:3,style:{backgroundColor:o.colorBgContainer,borderColor:o.colorBorder,color:o.colorText}})}),e.jsx(t.Item,{label:"Profile Image",name:"image",valuePropName:"file",labelCol:{style:{color:o.colorText}},children:e.jsx(B,{maxCount:1,accept:"image/*",beforeUpload:()=>!1,children:e.jsx(s,{icon:e.jsx(v,{}),children:"Upload Image"})})}),E&&e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx("img",{src:E,alt:"Preview",style:{maxWidth:"200px",maxHeight:"200px"}})}),e.jsx(t.Item,{label:"Application Form",name:"application_form",valuePropName:"file",children:e.jsx(B,{maxCount:1,accept:".pdf,.doc,.docx,.jpeg,.png,.jpg",beforeUpload:()=>!1,children:e.jsx(s,{icon:e.jsx(v,{}),children:"Upload Application Form"})})})]})}),e.jsxs(I,{title:"Archive Member",open:V,onCancel:()=>{S(!1),T(null)},onOk:()=>K(H),okText:"Archive",cancelText:"Cancel",okButtonProps:{danger:!0},centered:!0,styles:{mask:{backgroundColor:"rgba(0, 0, 0, 0.45)"}},children:[e.jsx("p",{children:"Are you sure you want to archive this member?"}),e.jsx("p",{style:{color:o.colorTextSecondary,fontSize:"12px"},children:"This action will soft delete the member record. You can restore it later from the archived members list."})]}),e.jsx(I,{title:"Import Members",open:X,onCancel:z,width:600,centered:!0,footer:[e.jsx(s,{onClick:z,children:"Cancel"},"cancel"),e.jsx(s,{type:"primary",loading:A,onClick:Z,disabled:!w,children:"Import Members"},"submit")],styles:{body:{maxHeight:"calc(100vh - 240px)",overflowY:"auto",paddingBottom:"16px"},mask:{backgroundColor:"rgba(0, 0, 0, 0.45)"}},children:e.jsxs("div",{children:[e.jsx("p",{style:{color:o.colorTextSecondary,marginBottom:"16px",fontSize:"13px"},children:"Upload a CSV or Excel file to import members in bulk. Make sure your file follows the required format."}),e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx(B,{accept:".csv,.xlsx,.xls",maxCount:1,beforeUpload:()=>!1,onChange:r=>{r.fileList.length>0?f(r.fileList[0].originFileObj):f(null)},onRemove:()=>{f(null)},listType:"text",style:{width:"100%"},children:e.jsxs("div",{style:{border:`2px dashed ${o.colorPrimary}`,borderRadius:"8px",padding:"32px 24px",textAlign:"center",backgroundColor:o.colorBgContainer,cursor:"pointer",transition:"all 0.3s",width:"100%"},children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"üìÅ"}),e.jsx("p",{style:{color:o.colorText,fontWeight:"bold",marginBottom:"4px",fontSize:"14px"},children:"Click to upload or drag and drop"}),e.jsx("p",{style:{color:o.colorTextSecondary,fontSize:"12px",margin:"0"},children:"CSV, XLSX, or XLS files"})]})})}),e.jsx("div",{style:{marginBottom:"16px",textAlign:"center"},children:e.jsx("a",{href:route("members.template"),download:!0,children:e.jsx(s,{type:"dashed",icon:e.jsx(W,{}),block:!0,size:"small",children:"Download Import Template"})})}),e.jsxs("div",{style:{backgroundColor:o.colorBgElevated,border:`1px solid ${o.colorBorder}`,borderRadius:"6px",padding:"12px"},children:[e.jsx("p",{style:{color:o.colorText,fontWeight:"bold",marginBottom:"8px",margin:"0 0 8px 0",fontSize:"12px"},children:"Required Columns"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:o.colorSuccess,fontWeight:"bold",margin:"0 0 2px 0",fontSize:"11px"},children:"‚úì first_name"}),e.jsx("p",{style:{color:o.colorTextSecondary,margin:"0",fontSize:"11px"},children:"First name"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:o.colorSuccess,fontWeight:"bold",margin:"0 0 2px 0",fontSize:"11px"},children:"‚úì surname"}),e.jsx("p",{style:{color:o.colorTextSecondary,margin:"0",fontSize:"11px"},children:"Last name"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:o.colorSuccess,fontWeight:"bold",margin:"0 0 2px 0",fontSize:"11px"},children:"‚úì email"}),e.jsx("p",{style:{color:o.colorTextSecondary,margin:"0",fontSize:"11px"},children:"Unique email"})]})]})]})]})})]})})}export{ro as default};
