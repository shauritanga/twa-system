import{b as le,e as mt,g as ut,d as We,r as y,f as be,c as Y,R as v,h as pt,k as xt,l as ht,m as ft,J as Oe,j as e,t as gt,S as ne,Q as yt}from"./app-D2e3E3XV.js";import{o as ae,d as bt,m as jt,p as Ct,q as St,j as He,i as qe,r as vt,h as Ge,s as ge,t as wt,v as Tt,w as Re,x as $t,y as It,z as kt,S as K,k as Xe,E as Pt,F as Mt,B as L,R as xe,C as U,A as Ft,G as Rt,D as _e}from"./AdminSidebarLayout-COqDSJm5.js";import{d as N}from"./dayjs.min-sc-J1EWQ.js";import{F as S}from"./index-D4xQY2I8.js";import{M as je,R as Ee}from"./index-DsYq67bJ.js";import{A as Se}from"./index-Dv79h3uU.js";import{R as _t}from"./InfoCircleOutlined-BrJJWW9d.js";import{I as G}from"./index-BvjKgjyF.js";import{S as H}from"./index-dQJIm9ox.js";import{T as ie}from"./index-CfnwjONs.js";import{D as ve}from"./index-SHICJdD7.js";import{N as Et,u as Bt,a as Nt,A as Dt,s as _}from"./index-BCmZvyIU.js";import{R as zt}from"./CheckCircleFilled-BiH3Zm4C.js";import{R as At,a as Lt}from"./InfoCircleFilled-bVzp4Yp4.js";import{R as we}from"./CheckCircleOutlined-A7kAbhow.js";import{P as Yt}from"./progress-CNXy_6Cu.js";import{R as Be,C as Z}from"./row-C-LMzcQh.js";import{R as Ne}from"./useIcons-Bk-sqBIx.js";import{F as M}from"./Table-BwkSv8cC.js";import{T as he}from"./index-m_fbIKNS.js";import{R as De}from"./getAllowClear-BoT9aE4f.js";import{R as ze}from"./BankOutlined-l5YwWDwk.js";import{R as Ae}from"./MoreOutlined-DoUi7suo.js";import{R as Wt}from"./EditOutlined-DJbavOcF.js";import"./SessionTimeout-CfqEmPbo.js";import"./Modal-J3vqZBmM.js";import"./transition-BB8nYaSI.js";import"./PrimaryButton-CAxNNQMa.js";import"./SecondaryButton-DEXX7yh7.js";import"./CSSMotionList-1BX_Nue5.js";import"./useForm-D6sLoAH1.js";import"./Input-xs5RiVsA.js";import"./EyeOutlined-ByHKmIV0.js";import"./TextArea-Ba86vcsD.js";import"./index-DD8aZ74l.js";import"./DownOutlined-D3g4QtBj.js";import"./CalendarOutlined-D-3mNytr.js";import"./ClockCircleOutlined-qBW9qdtJ.js";import"./index-B8k0MQXY.js";const Ot=t=>{const{componentCls:o,notificationMarginEdge:a,animationMaxHeight:i}=t,u=`${o}-notice`,x=new ae("antNotificationFadeIn",{"0%":{transform:"translate3d(100%, 0, 0)",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",opacity:1}}),l=new ae("antNotificationTopFadeIn",{"0%":{top:-i,opacity:0},"100%":{top:0,opacity:1}}),p=new ae("antNotificationBottomFadeIn",{"0%":{bottom:t.calc(i).mul(-1).equal(),opacity:0},"100%":{bottom:0,opacity:1}}),h=new ae("antNotificationLeftFadeIn",{"0%":{transform:"translate3d(-100%, 0, 0)",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",opacity:1}});return{[o]:{[`&${o}-top, &${o}-bottom`]:{marginInline:0,[u]:{marginInline:"auto auto"}},[`&${o}-top`]:{[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationName:l}},[`&${o}-bottom`]:{[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationName:p}},[`&${o}-topRight, &${o}-bottomRight`]:{[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationName:x}},[`&${o}-topLeft, &${o}-bottomLeft`]:{marginRight:{value:0,_skip_check_:!0},marginLeft:{value:a,_skip_check_:!0},[u]:{marginInlineEnd:"auto",marginInlineStart:0},[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationName:h}}}}},Ht=["top","topLeft","topRight","bottom","bottomLeft","bottomRight"],qt={topLeft:"left",topRight:"right",bottomLeft:"left",bottomRight:"right",top:"left",bottom:"left"},Gt=(t,o)=>{const{componentCls:a}=t;return{[`${a}-${o}`]:{[`&${a}-stack > ${a}-notice-wrapper`]:{[o.startsWith("top")?"top":"bottom"]:0,[qt[o]]:{value:0,_skip_check_:!0}}}}},Xt=t=>{const o={};for(let a=1;a<t.notificationStackLayer;a++)o[`&:nth-last-child(${a+1})`]={overflow:"hidden",[`& > ${t.componentCls}-notice`]:{opacity:0,transition:`opacity ${t.motionDurationMid}`}};return{[`&:not(:nth-last-child(-n+${t.notificationStackLayer}))`]:{opacity:0,overflow:"hidden",color:"transparent",pointerEvents:"none"},...o}},Vt=t=>{const o={};for(let a=1;a<t.notificationStackLayer;a++)o[`&:nth-last-child(${a+1})`]={background:t.colorBgBlur,backdropFilter:"blur(10px)","-webkit-backdrop-filter":"blur(10px)"};return{...o}},Ut=t=>{const{componentCls:o}=t;return{[`${o}-stack`]:{[`& > ${o}-notice-wrapper`]:{transition:`transform ${t.motionDurationSlow}, backdrop-filter 0s`,willChange:"transform, opacity",position:"absolute",...Xt(t)}},[`${o}-stack:not(${o}-stack-expanded)`]:{[`& > ${o}-notice-wrapper`]:{...Vt(t)}},[`${o}-stack${o}-stack-expanded`]:{[`& > ${o}-notice-wrapper`]:{"&:not(:nth-last-child(-n + 1))":{opacity:1,overflow:"unset",color:"inherit",pointerEvents:"auto",[`& > ${t.componentCls}-notice`]:{opacity:1}},"&:after":{content:'""',position:"absolute",height:t.margin,width:"100%",insetInline:0,bottom:t.calc(t.margin).mul(-1).equal(),background:"transparent",pointerEvents:"auto"}}},...Ht.map(a=>Gt(t,a)).reduce((a,i)=>({...a,...i}),{})}},Ve=t=>{const{iconCls:o,componentCls:a,boxShadow:i,fontSizeLG:u,notificationMarginBottom:x,borderRadiusLG:l,colorSuccess:p,colorInfo:h,colorWarning:d,colorError:c,colorTextHeading:f,notificationBg:n,notificationPadding:T,notificationMarginEdge:g,progressBg:m,notificationProgressHeight:j,fontSize:F,lineHeight:k,width:E,notificationIconSize:$,colorText:P,colorSuccessBg:R,colorErrorBg:z,colorInfoBg:A,colorWarningBg:W}=t,b=`${a}-notice`;return{position:"relative",marginBottom:x,marginInlineStart:"auto",background:n,borderRadius:l,boxShadow:i,[b]:{padding:T,width:E,maxWidth:`calc(100vw - ${le(t.calc(g).mul(2).equal())})`,lineHeight:k,wordWrap:"break-word",borderRadius:l,overflow:"hidden","&-success":R?{background:R}:{},"&-error":z?{background:z}:{},"&-info":A?{background:A}:{},"&-warning":W?{background:W}:{}},[`${b}-title`]:{marginBottom:t.marginXS,color:f,fontSize:u,lineHeight:t.lineHeightLG},[`${b}-description`]:{fontSize:F,color:P,marginTop:t.marginXS},[`${b}-closable ${b}-title`]:{paddingInlineEnd:t.paddingLG},[`${b}-with-icon ${b}-title`]:{marginBottom:t.marginXS,marginInlineStart:t.calc(t.marginSM).add($).equal(),fontSize:u},[`${b}-with-icon ${b}-description`]:{marginInlineStart:t.calc(t.marginSM).add($).equal(),fontSize:F},[`${b}-icon`]:{position:"absolute",fontSize:$,lineHeight:1,[`&-success${o}`]:{color:p},[`&-info${o}`]:{color:h},[`&-warning${o}`]:{color:d},[`&-error${o}`]:{color:c}},[`${b}-close`]:{position:"absolute",top:t.notificationPaddingVertical,insetInlineEnd:t.notificationPaddingHorizontal,color:t.colorIcon,outline:"none",width:t.notificationCloseButtonSize,height:t.notificationCloseButtonSize,borderRadius:t.borderRadiusSM,transition:`background-color ${t.motionDurationMid}, color ${t.motionDurationMid}`,display:"flex",alignItems:"center",justifyContent:"center",background:"none",border:"none","&:hover":{color:t.colorIconHover,backgroundColor:t.colorBgTextHover},"&:active":{backgroundColor:t.colorBgTextActive},...ut(t)},[`${b}-progress`]:{position:"absolute",display:"block",appearance:"none",inlineSize:`calc(100% - ${le(l)} * 2)`,left:{_skip_check_:!0,value:l},right:{_skip_check_:!0,value:l},bottom:0,blockSize:j,border:0,"&, &::-webkit-progress-bar":{borderRadius:l,backgroundColor:"rgba(0, 0, 0, 0.04)"},"&::-moz-progress-bar":{background:m},"&::-webkit-progress-value":{borderRadius:l,background:m}},[`${b}-actions`]:{float:"right",marginTop:t.marginSM}}},Zt=t=>{const{componentCls:o,notificationMarginBottom:a,notificationMarginEdge:i,motionDurationMid:u,motionEaseInOut:x}=t,l=`${o}-notice`,p=new ae("antNotificationFadeOut",{"0%":{maxHeight:t.animationMaxHeight,marginBottom:a},"100%":{maxHeight:0,marginBottom:0,paddingTop:0,paddingBottom:0,opacity:0}});return[{[o]:{...mt(t),position:"fixed",zIndex:t.zIndexPopup,marginRight:{value:i,_skip_check_:!0},[`${o}-hook-holder`]:{position:"relative"},[`${o}-fade-appear-prepare`]:{opacity:"0 !important"},[`${o}-fade-enter, ${o}-fade-appear`]:{animationDuration:t.motionDurationMid,animationTimingFunction:x,animationFillMode:"both",opacity:0,animationPlayState:"paused"},[`${o}-fade-leave`]:{animationTimingFunction:x,animationFillMode:"both",animationDuration:u,animationPlayState:"paused"},[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationPlayState:"running"},[`${o}-fade-leave${o}-fade-leave-active`]:{animationName:p,animationPlayState:"running"},"&-rtl":{direction:"rtl",[`${l}-actions`]:{float:"left"}}}},{[o]:{[`${l}-wrapper`]:Ve(t)}}]},Ue=t=>({zIndexPopup:t.zIndexPopupBase+Ct+50,width:384,progressBg:`linear-gradient(90deg, ${t.colorPrimaryBorderHover}, ${t.colorPrimary})`,colorSuccessBg:void 0,colorErrorBg:void 0,colorInfoBg:void 0,colorWarningBg:void 0}),Ze=t=>{const o=t.paddingMD,a=t.paddingLG;return jt(t,{notificationBg:t.colorBgElevated,notificationPaddingVertical:o,notificationPaddingHorizontal:a,notificationIconSize:t.calc(t.fontSizeLG).mul(t.lineHeightLG).equal(),notificationCloseButtonSize:t.calc(t.controlHeightLG).mul(.55).equal(),notificationMarginBottom:t.margin,notificationPadding:`${le(t.paddingMD)} ${le(t.paddingContentHorizontalLG)}`,notificationMarginEdge:t.marginLG,animationMaxHeight:150,notificationStackLayer:3,notificationProgressHeight:2})},Ke=bt("Notification",t=>{const o=Ze(t);return[Zt(o),Ot(o),Ut(o)]},Ue),Kt=St(["Notification","PurePanel"],t=>{const o=`${t.componentCls}-notice`,a=Ze(t);return{[`${o}-pure-panel`]:{...Ve(a),width:a.width,maxWidth:`calc(100vw - ${le(t.calc(a.notificationMarginEdge).mul(2).equal())})`,margin:0}}},Ue);function Te(t,o){return o===null||o===!1?null:o||y.createElement(Ge,{className:`${t}-close-icon`})}const Jt={success:zt,info:Lt,error:wt,warning:At},Je=t=>{const{prefixCls:o,icon:a,type:i,title:u,description:x,actions:l,role:p="alert",styles:h,classNames:d}=t;let c=null;return a?c=y.createElement("span",{className:Y(`${o}-icon`,d.icon),style:h.icon},a):i&&(c=y.createElement(Jt[i]||null,{className:Y(`${o}-icon`,d.icon,`${o}-icon-${i}`),style:h.icon})),y.createElement("div",{className:Y({[`${o}-with-icon`]:c}),role:p},c,y.createElement("div",{className:Y(`${o}-title`,d.title),style:h.title},u),x&&y.createElement("div",{className:Y(`${o}-description`,d.description),style:h.description},x),l&&y.createElement("div",{className:Y(`${o}-actions`,d.actions),style:h.actions},l))},Qt=t=>{const{prefixCls:o,icon:a,type:i,message:u,title:x,description:l,btn:p,actions:h,closeIcon:d,className:c,style:f,styles:n,classNames:T,closable:g,...m}=t,{getPrefixCls:j,className:F,style:k,classNames:E,styles:$}=We("notification"),[P,R]=He([E,T],[$,n],{props:t}),{notification:z}=y.useContext(be),A=h??p,W=x??u,b=o||j("notification"),X=`${b}-notice`,q=qe(b),[J,Q]=Ke(b,q),[ee,I,,te]=vt(ge(t),ge(z),{closable:!0,closeIcon:y.createElement(Ge,{className:`${b}-close-icon`}),closeIconRender:re=>Te(b,re)}),oe=ee?{onClose:g&&typeof g=="object"?g==null?void 0:g.onClose:void 0,closeIcon:I,...te}:!1;return y.createElement("div",{className:Y(`${X}-pure-panel`,J,c,Q,q,P.root),style:R.root},y.createElement(Kt,{prefixCls:b}),y.createElement(Et,{style:{...k,...f},...m,prefixCls:b,eventKey:"pure",duration:null,closable:oe,className:Y(c,F),content:y.createElement(Je,{classNames:P,styles:R,prefixCls:X,icon:a,type:i,title:W,description:l,actions:A})}))};function eo(t,o,a){let i;switch(t){case"top":i={left:"50%",transform:"translateX(-50%)",right:"auto",top:o,bottom:"auto"};break;case"topLeft":i={left:0,top:o,bottom:"auto"};break;case"topRight":i={right:0,top:o,bottom:"auto"};break;case"bottom":i={left:"50%",transform:"translateX(-50%)",right:"auto",top:"auto",bottom:a};break;case"bottomLeft":i={left:0,top:"auto",bottom:a};break;default:i={right:0,top:"auto",bottom:a};break}return i}function to(t){return{motionName:`${t}-fade`}}function oo(t,o,a){return typeof t<"u"?t:typeof(o==null?void 0:o.closeIcon)<"u"?o.closeIcon:a==null?void 0:a.closeIcon}const Le=24,ro=4.5,no="topRight",so=({children:t,prefixCls:o})=>{const a=qe(o),[i,u]=Ke(o,a);return v.createElement(Nt,{classNames:{list:Y(i,u,a)}},t)},ao=(t,{prefixCls:o,key:a})=>v.createElement(so,{prefixCls:o,key:a},t),io=v.forwardRef((t,o)=>{const{top:a,bottom:i,prefixCls:u,getContainer:x,maxCount:l,rtl:p,onAllRemoved:h,stack:d,duration:c=ro,pauseOnHover:f=!0,showProgress:n}=t,{getPrefixCls:T,getPopupContainer:g,direction:m}=We("notification"),{notification:j}=y.useContext(be),[,F]=pt(),k=u||T("notification"),E=y.useMemo(()=>typeof c=="number"&&c>0?c:!1,[c]),$=X=>eo(X,a??Le,i??Le),P=()=>Y({[`${k}-rtl`]:p??m==="rtl"}),R=()=>to(k),[z,A]=Bt({prefixCls:k,style:$,className:P,motion:R,closable:{closeIcon:Te(k)},duration:E,getContainer:()=>(x==null?void 0:x())||(g==null?void 0:g())||document.body,maxCount:l,pauseOnHover:f,showProgress:n,onAllRemoved:h,renderNotifications:ao,stack:d===!1?!1:{threshold:typeof d=="object"?d==null?void 0:d.threshold:void 0,offset:8,gap:F.margin}}),[W,b]=He([j==null?void 0:j.classNames,t==null?void 0:t.classNames],[j==null?void 0:j.styles,t==null?void 0:t.styles],{props:t});return v.useImperativeHandle(o,()=>({...z,prefixCls:k,notification:j,classNames:W,styles:b})),A});function Qe(t){const o=v.useRef(null);xt();const{notification:a}=v.useContext(be);return[v.useMemo(()=>{const u=h=>{if(!o.current)return;const{open:d,prefixCls:c,notification:f,classNames:n,styles:T}=o.current,g=(f==null?void 0:f.className)||{},m=(f==null?void 0:f.style)||{},j=`${c}-notice`,{title:F,message:k,description:E,icon:$,type:P,btn:R,actions:z,className:A,style:W,role:b="alert",closeIcon:X,closable:q,classNames:J={},styles:Q={},...ee}=h,I=F??k,te=z??R,oe=Te(j,oo(X,t,f)),[re,de,,O]=Tt(ge({...t||{},...h}),ge(a),{closable:!0,closeIcon:oe}),V=re?{onClose:q&&typeof q=="object"?q.onClose:void 0,closeIcon:de,...O}:!1,Ce=Re(J,{props:h}),se=Re(Q,{props:h}),me=$t(void 0,n,Ce),ue=It(T,se);return d({placement:(t==null?void 0:t.placement)??no,...ee,content:v.createElement(Je,{prefixCls:j,icon:$,type:P,title:I,description:E,actions:te,role:b,classNames:me,styles:ue}),className:Y({[`${j}-${P}`]:P},A,g,me.root),style:{...m,...ue.root,...W},closable:V})},l={open:u,destroy:h=>{var d,c;h!==void 0?(d=o.current)==null||d.close(h):(c=o.current)==null||c.destroy()}};return["success","info","warning","error"].forEach(h=>{l[h]=d=>u({...d,type:h})}),l},[t,a]),v.createElement(io,{key:"notification-holder",...t,ref:o})]}function lo(t){return Qe(t)}let D=null,fe=t=>t(),ye=[],ce={};function Ye(){const{getContainer:t,rtl:o,maxCount:a,top:i,bottom:u,showProgress:x,pauseOnHover:l}=ce,p=(t==null?void 0:t())||document.body;return{getContainer:()=>p,rtl:o,maxCount:a,top:i,bottom:u,showProgress:x,pauseOnHover:l}}const co=v.forwardRef((t,o)=>{const{notificationConfig:a,sync:i}=t,{getPrefixCls:u}=y.useContext(be),x=ce.prefixCls||u("notification"),l=y.useContext(Dt),[p,h]=Qe({...a,prefixCls:x,...l.notification});return v.useEffect(i,[]),v.useImperativeHandle(o,()=>{const d={...p};return Object.keys(d).forEach(c=>{d[c]=(...f)=>(i(),p[c].apply(p,f))}),{instance:d,sync:i}}),h}),mo=v.forwardRef((t,o)=>{const[a,i]=v.useState(Ye),u=()=>{i(Ye)};v.useEffect(u,[]);const x=ft(),l=x.getRootPrefixCls(),p=x.getIconPrefixCls(),h=x.getTheme(),d=v.createElement(co,{ref:o,sync:u,notificationConfig:a});return v.createElement(ht,{prefixCls:l,iconPrefixCls:p,theme:h},x.holderRender?x.holderRender(d):d)}),$e=()=>{if(!D){const t=document.createDocumentFragment(),o={fragment:t};D=o,fe(()=>{kt(v.createElement(mo,{ref:a=>{const{instance:i,sync:u}=a||{};Promise.resolve().then(()=>{!o.instance&&i&&(o.instance=i,o.sync=u,$e())})}}),t)});return}D.instance&&(ye.forEach(t=>{switch(t.type){case"open":{fe(()=>{D.instance.open({...ce,...t.config})});break}case"destroy":fe(()=>{var o;(o=D==null?void 0:D.instance)==null||o.destroy(t.key)});break}}),ye=[])};function uo(t){ce={...ce,...t},fe(()=>{var o;(o=D==null?void 0:D.sync)==null||o.call(D)})}function et(t){ye.push({type:"open",config:t}),$e()}const po=t=>{ye.push({type:"destroy",key:t}),$e()},xo=["success","info","warning","error"],ho={open:et,destroy:po,config:uo,useNotification:lo,_InternalPanelDoNotUseOrYouWillBeFired:Qt},Ie=ho;xo.forEach(t=>{Ie[t]=o=>et({...o,type:t})});const{TextArea:fo}=G,{Option:go}=H;function yo({open:t,onClose:o,members:a,defaultType:i="monthly"}){const{props:u}=Oe(),x=u.settings||{},l=x.monthly_contribution_amount?parseFloat(x.monthly_contribution_amount.value):5e4,[p]=S.useForm(),[h,d]=y.useState(!1),[c,f]=y.useState(i);v.useEffect(()=>{t&&f(i)},[t,i]),v.useEffect(()=>{t&&setTimeout(()=>{p.resetFields();const m={member_id:void 0,date:N(),notes:""};c==="monthly"?(m.amount=l,m.purpose="Monthly Contribution"):(m.amount=void 0,m.purpose=""),p.setFieldsValue(m)},0)},[t,c,l,p]);const n=m=>new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS",minimumFractionDigits:0,maximumFractionDigits:0}).format(m||0),T=async m=>{var F,k,E;d(!0);const j={member_id:m.member_id,type:c,amount:m.amount,date:m.date.format("YYYY-MM-DD"),purpose:m.purpose,notes:m.notes||""};try{(await window.axios.post(route("contributions.store"),j,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}})).data.success&&(Ie.success({message:"Success!",description:"Contribution recorded successfully!",icon:e.jsx(we,{style:{color:"#52c41a"}}),placement:"topRight",duration:3}),p.resetFields(),o(),setTimeout(()=>{window.location.reload()},1500))}catch($){if(console.error("Error:",$),((F=$.response)==null?void 0:F.status)===422){const P=$.response.data.errors;Object.keys(P).forEach(R=>{_.error(P[R][0])})}else(E=(k=$.response)==null?void 0:k.data)!=null&&E.message?_.error($.response.data.message):_.error("Failed to record contribution. Please try again.")}finally{d(!1)}},g=()=>{p.resetFields(),o()};return v.useEffect(()=>{t||p.resetFields()},[t,p]),e.jsx(je,{title:e.jsxs(K,{children:[e.jsx(Xe,{style:{color:"#1890ff"}}),e.jsx("span",{children:c==="monthly"?"Add Monthly Contribution":"Add Other Contribution"})]}),open:t,onCancel:g,onOk:()=>p.submit(),confirmLoading:h,okText:c==="monthly"?"Add Monthly Contribution":"Add Other Contribution",cancelText:"Cancel",width:600,styles:{body:{maxHeight:"70vh",overflowY:"auto"}},centered:!0,destroyOnClose:!0,children:e.jsxs(S,{form:p,layout:"vertical",onFinish:T,children:[e.jsx(Se,{message:c==="monthly"?"Monthly Contribution":"Other Contribution",description:c==="monthly"?"System handles multiple payments and advance payments automatically. Excess amounts are distributed to future months.":"Record special projects, donations, or other non-monthly contributions.",type:"info",icon:e.jsx(_t,{}),showIcon:!0,style:{marginBottom:24}}),e.jsx(S.Item,{name:"type",hidden:!0,initialValue:c,children:e.jsx(G,{})}),e.jsx(S.Item,{label:"Member",name:"member_id",rules:[{required:!0,message:"Please select a member"}],children:e.jsx(H,{showSearch:!0,placeholder:"Select a member",optionFilterProp:"children",filterOption:(m,j)=>j.children.toLowerCase().includes(m.toLowerCase()),children:a.map(m=>e.jsx(go,{value:m.id,children:m.name},m.id))})}),e.jsx(S.Item,{label:"Amount (TZS)",name:"amount",rules:[{required:!0,message:"Please enter an amount"},{type:"number",min:0,message:"Amount must be positive"}],extra:c==="monthly"?`Monthly contribution: ${n(l)} â€¢ Smart distribution enabled`:"Enter amount for special contribution",children:e.jsx(ie,{style:{width:"100%"},placeholder:"Enter amount",formatter:m=>`${m}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:m=>m.replace(/\$\s?|(,*)/g,""),prefix:"TZS"})}),e.jsx(S.Item,{label:"Date",name:"date",rules:[{required:!0,message:"Please select a date"}],children:e.jsx(ve,{style:{width:"100%"},format:"YYYY-MM-DD"})}),e.jsx(S.Item,{label:"Purpose",name:"purpose",rules:[{required:!0,message:"Please enter a purpose"}],children:e.jsx(G,{placeholder:c==="monthly"?"Monthly Contribution":"Enter purpose (e.g., Building Fund, Equipment)",autoComplete:"new-password",style:{backgroundColor:"transparent"},styles:{input:{backgroundColor:"transparent",WebkitBoxShadow:"none",boxShadow:"none"}}})}),e.jsx(S.Item,{label:"Notes (Optional)",name:"notes",children:e.jsx(fo,{rows:3,placeholder:"Additional notes about this contribution..."})})]},`form-${c}`)},`contribution-form-${c}-${t}`)}const{Option:bo}=H,{TextArea:lr}=G;function jo({open:t,onClose:o,members:a,editingLoan:i}){const[u]=S.useForm(),[x,l]=y.useState(!1),p=async d=>{var f,n,T;l(!0);const c={member_id:d.member_id,amount:d.amount,interest_rate:d.interest_rate,purpose:d.purpose,term_months:d.term_months,due_date:d.due_date.format("YYYY-MM-DD")};try{let g;i?g=await window.axios.put(route("loans.update",i.id),c,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}):g=await window.axios.post(route("loans.store"),c,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}),g.data.success&&(Ie.success({message:"Success!",description:i?"Loan updated successfully!":"Loan created successfully!",icon:e.jsx(we,{style:{color:"#52c41a"}}),placement:"topRight",duration:3}),u.resetFields(),o(),setTimeout(()=>{window.location.reload()},1500))}catch(g){if(console.error("Error:",g),((f=g.response)==null?void 0:f.status)===422){const m=g.response.data.errors;Object.keys(m).forEach(j=>{_.error(m[j][0])})}else(T=(n=g.response)==null?void 0:n.data)!=null&&T.message?_.error(g.response.data.message):_.error(i?"Failed to update loan. Please try again.":"Failed to create loan. Please try again.")}finally{l(!1)}},h=()=>{u.resetFields(),o()};return y.useEffect(()=>{i&&t?u.setFieldsValue({member_id:i.member_id,amount:i.amount,interest_rate:i.interest_rate,purpose:i.purpose,term_months:i.term_months,due_date:i.due_date?N(i.due_date):N().add(12,"months")}):!i&&t&&u.setFieldsValue({interest_rate:13,term_months:12,due_date:N().add(12,"months")})},[i,t,u]),e.jsx(je,{title:e.jsxs(K,{children:[e.jsx(Xe,{style:{color:"#1890ff"}}),e.jsx("span",{children:i?"Edit Loan":"Create Loan"})]}),open:t,onCancel:h,onOk:()=>u.submit(),confirmLoading:x,okText:i?"Update Loan":"Create Loan",cancelText:"Cancel",width:600,styles:{body:{maxHeight:"70vh",overflowY:"auto"}},centered:!0,children:e.jsxs(S,{form:u,layout:"vertical",onFinish:p,initialValues:{interest_rate:13,term_months:12,due_date:N().add(12,"months")},children:[e.jsx(S.Item,{label:"Member",name:"member_id",rules:[{required:!0,message:"Please select a member"}],children:e.jsx(H,{showSearch:!0,placeholder:"Select a member",optionFilterProp:"children",filterOption:(d,c)=>c.children.toLowerCase().includes(d.toLowerCase()),children:((a==null?void 0:a.data)||a||[]).map(d=>e.jsx(bo,{value:d.id,children:d.name},d.id))})}),e.jsx(S.Item,{label:"Loan Amount (TZS)",name:"amount",rules:[{required:!0,message:"Please enter loan amount"},{type:"number",min:1,message:"Amount must be greater than 0"}],children:e.jsx(ie,{style:{width:"100%"},placeholder:"Enter loan amount",formatter:d=>`${d}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:d=>d.replace(/\$\s?|(,*)/g,""),prefix:"TZS"})}),e.jsx(S.Item,{label:"Interest Rate (% per month)",name:"interest_rate",rules:[{required:!0,message:"Please enter interest rate"},{type:"number",min:0,max:100,message:"Interest rate must be between 0 and 100"}],children:e.jsx(ie,{style:{width:"100%"},placeholder:"Enter monthly interest rate",suffix:"%",step:.1,precision:2})}),e.jsx(S.Item,{label:"Purpose",name:"purpose",rules:[{required:!0,message:"Please enter loan purpose"}],children:e.jsx(G,{placeholder:"Enter loan purpose (e.g., Business expansion, Emergency, etc.)"})}),e.jsx(S.Item,{label:"Loan Term (Months)",name:"term_months",rules:[{required:!0,message:"Please enter loan term"},{type:"number",min:1,max:60,message:"Term must be between 1 and 60 months"}],children:e.jsx(ie,{style:{width:"100%"},placeholder:"Enter loan term in months",min:1,max:60})}),e.jsx(S.Item,{label:"Due Date",name:"due_date",rules:[{required:!0,message:"Please select due date"}],children:e.jsx(ve,{style:{width:"100%"},format:"YYYY-MM-DD",disabledDate:d=>d&&d<N().startOf("day")})})]})})}const{Option:Co}=H;function So({open:t,onClose:o,members:a}){const[i]=S.useForm(),[u,x]=y.useState(!1),[l,p]=y.useState({isProcessing:!1,total:0,sent:0,failed:0,currentStep:"idle",errors:[]}),h=async c=>{var n,T;x(!0),p({isProcessing:!0,total:0,sent:0,failed:0,currentStep:"creating",errors:[]});const f={member_id:c.member_id,amount:c.amount,date:c.date.format("YYYY-MM-DD"),purpose:c.purpose};try{const m=(await window.axios.post(route("disaster-payments.store"),f,{headers:{"X-Requested-With":"XMLHttpRequest"}})).data;m.success&&(p({isProcessing:!1,total:m.email_results.total,sent:m.email_results.sent,failed:m.email_results.failed,currentStep:"complete",errors:m.email_results.errors||[]}),_.success(`Disbursement recorded! Notifications sent to ${m.email_results.sent} members.`),setTimeout(()=>{i.resetFields(),o(),window.location.reload()},3e3))}catch(g){console.error("Error:",g),p({isProcessing:!1,total:0,sent:0,failed:0,currentStep:"idle",errors:[]}),(T=(n=g.response)==null?void 0:n.data)!=null&&T.errors?Object.keys(g.response.data.errors).forEach(m=>{_.error(g.response.data.errors[m][0])}):_.error("Failed to record disbursement. Please try again.")}finally{x(!1)}},d=()=>{l.isProcessing||(i.resetFields(),p({isProcessing:!1,total:0,sent:0,failed:0,currentStep:"idle",errors:[]}),o())};return e.jsx(je,{title:e.jsxs(K,{children:[e.jsx(Mt,{style:{color:"#1890ff"}}),e.jsx("span",{children:"Add Disbursement"})]}),open:t,onCancel:d,onOk:()=>i.submit(),confirmLoading:u||l.isProcessing,okText:l.isProcessing?"Processing...":"Add Disbursement",cancelText:"Cancel",width:600,closable:!l.isProcessing,maskClosable:!l.isProcessing,styles:{body:{maxHeight:"70vh",overflowY:"auto"}},centered:!0,children:e.jsxs(S,{form:i,layout:"vertical",onFinish:h,initialValues:{date:N()},children:[e.jsx(S.Item,{label:"Member",name:"member_id",rules:[{required:!0,message:"Please select a member"}],children:e.jsx(H,{showSearch:!0,placeholder:"Select a member",optionFilterProp:"children",filterOption:(c,f)=>f.children.toLowerCase().includes(c.toLowerCase()),disabled:l.isProcessing,children:a.map(c=>e.jsx(Co,{value:c.id,children:c.name},c.id))})}),e.jsx(S.Item,{label:"Amount (TZS)",name:"amount",rules:[{required:!0,message:"Please enter an amount"},{type:"number",min:0,message:"Amount must be positive"}],children:e.jsx(ie,{style:{width:"100%"},placeholder:"Enter disbursement amount",formatter:c=>`${c}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:c=>c.replace(/\$\s?|(,*)/g,""),prefix:"TZS",disabled:l.isProcessing})}),e.jsx(S.Item,{label:"Date",name:"date",rules:[{required:!0,message:"Please select a date"}],children:e.jsx(ve,{style:{width:"100%"},format:"YYYY-MM-DD",disabled:l.isProcessing})}),e.jsx(S.Item,{label:"Purpose",name:"purpose",rules:[{required:!0,message:"Please enter a purpose"}],children:e.jsx(G,{placeholder:"Purpose of disbursement (e.g., Medical Emergency, Funeral)",disabled:l.isProcessing})}),l.isProcessing&&e.jsx(Se,{message:l.currentStep==="creating"?"Creating disbursement...":"Sending email notifications...",description:l.total>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx(Yt,{percent:Math.round(l.sent/l.total*100),status:"active"}),e.jsxs("div",{style:{marginTop:8,fontSize:12},children:["Sent ",l.sent," of ",l.total," notifications",l.failed>0&&` (${l.failed} failed)`]})]}),type:"info",icon:e.jsx(Pt,{}),showIcon:!0}),l.currentStep==="complete"&&e.jsx(Se,{message:"Email Notifications Complete",description:e.jsxs("div",{children:[e.jsxs("div",{children:["âœ… Successfully sent to ",l.sent," members"]}),l.failed>0&&e.jsxs("div",{style:{color:"#fa8c16"},children:["âš ï¸ Failed to send to ",l.failed," members"]})]}),type:"success",showIcon:!0})]})})}function cr(){var ke,Pe;const{members:t=[],allMembers:o=[],monthlyContributionsByMonth:a={},memberMonthlyTotal:i={},memberOtherTotal:u={},otherContributions:x={},otherContributionsSummary:l=[],loans:p={},penalties:h={},disasterPayments:d={},statistics:c={},filters:f={}}=Oe().props,{token:n}=gt.useToken(),[T,g]=y.useState(f.tab||"contributions"),[m,j]=y.useState(f.search||""),[F,k]=y.useState(f.year||new Date().getFullYear()),[E,$]=y.useState(f.month||"");v.useEffect(()=>{f.tab&&f.tab!==T&&g(f.tab)},[f.tab]);const[P,R]=y.useState(!1),[z,A]=y.useState("monthly"),[W,b]=y.useState(!1),[X,q]=y.useState(!1),[J,Q]=y.useState(null),ee=s=>{P?(R(!1),setTimeout(()=>{A(s),R(!0)},100)):(A(s),R(!0))},I=s=>new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS",minimumFractionDigits:0,maximumFractionDigits:0}).format(s||0),te=Array.from({length:new Date().getFullYear()-2018+1},(s,r)=>({label:String(2018+r),value:2018+r})).reverse(),oe=[{label:"All Months",value:""},{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}],re=()=>{ne.get(route("admin-portal.financials"),{search:m,year:F,month:E,tab:T})},de=()=>{j(""),k(new Date().getFullYear()),$(""),ne.get(route("admin-portal.financials"),{tab:T})},[O,V]=y.useState({open:!1,type:"",loan:null,confirmText:"",loading:!1}),Ce=async(s,r)=>{var w,B;V(C=>({...C,loading:!0}));try{let C;switch(r){case"disburse":C=await window.axios.patch(route("loans.disburse",s));break;case"repaid":C=await window.axios.patch(route("loans.markAsRepaid",s));break;case"delete":C=await window.axios.delete(route("loans.destroy",s));break;default:throw new Error("Unknown action")}C.data.success&&(_.success(C.data.message),V({open:!1,type:"",loan:null,confirmText:"",loading:!1}),setTimeout(()=>{window.location.reload()},1e3))}catch(C){console.error("Error:",C),(B=(w=C.response)==null?void 0:w.data)!=null&&B.message?_.error(C.response.data.message):_.error(`Failed to ${r} loan. Please try again.`)}finally{V(C=>({...C,loading:!1}))}},se=(s,r)=>{V({open:!0,type:r,loan:s,confirmText:"",loading:!1})},me=()=>{var B,C;const{type:s,loan:r,confirmText:w}=O;if(s==="delete"&&w!==((B=r.member)==null?void 0:B.name)){_.error(`Please type "${(C=r.member)==null?void 0:C.name}" to confirm deletion`);return}Ce(r.id,s)},ue=()=>{V({open:!1,type:"",loan:null,confirmText:"",loading:!1})},tt=async s=>{try{await ne.patch(route("penalties.markAsPaid",s.id),{},{onSuccess:()=>{_.success(`Penalty for ${s.member.name} marked as paid successfully`)},onError:r=>{_.error("Failed to mark penalty as paid"),console.error("Error:",r)}})}catch(r){_.error("An error occurred while marking penalty as paid"),console.error("Error:",r)}},pe=()=>{var w,B,C,Me,Fe;const{type:s,loan:r}=O;switch(s){case"disburse":return{title:e.jsxs(K,{children:[e.jsx(ze,{style:{color:"#1890ff"}}),e.jsx("span",{children:"Disburse Loan"})]}),content:e.jsxs("div",{style:{color:n.colorText},children:[e.jsx("p",{style:{marginBottom:"16px",fontSize:"14px",color:n.colorTextSecondary},children:"Are you sure you want to disburse this loan?"}),e.jsx("div",{style:{background:n.colorBgElevated,border:`1px solid ${n.colorBorder}`,padding:"16px",borderRadius:"8px",marginBottom:"16px"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Member"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorText},children:(w=r==null?void 0:r.member)==null?void 0:w.name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Principal"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:n.colorPrimary,fontFamily:"monospace"},children:I(r==null?void 0:r.amount)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Interest Rate"}),e.jsxs("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorText},children:[r==null?void 0:r.interest_rate,"% monthly"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Total Amount"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:n.colorSuccess,fontFamily:"monospace"},children:I((r==null?void 0:r.total_amount)||(r==null?void 0:r.amount))})]})]})}),e.jsx("div",{style:{background:n.colorInfoBg,border:`1px solid ${n.colorInfoBorder}`,padding:"12px",borderRadius:"6px",fontSize:"13px",color:n.colorTextSecondary},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:n.colorInfo,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",color:"white"},children:"ðŸ“Š"}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:n.colorInfo},children:"Accounting Impact:"}),e.jsx("br",{}),"This will create journal entries: Loans Receivable â†” Cash"]})]})})]}),okText:"Disburse Loan",okType:"primary"};case"repaid":return{title:e.jsxs(K,{children:[e.jsx(De,{style:{color:"#52c41a"}}),e.jsx("span",{children:"Mark Loan as Repaid"})]}),content:e.jsxs("div",{style:{color:n.colorText},children:[e.jsx("p",{style:{marginBottom:"16px",fontSize:"14px",color:n.colorTextSecondary},children:"Are you sure you want to mark this loan as repaid?"}),e.jsx("div",{style:{background:n.colorBgElevated,border:`1px solid ${n.colorBorder}`,padding:"16px",borderRadius:"8px",marginBottom:"16px"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Member"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorText},children:(B=r==null?void 0:r.member)==null?void 0:B.name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Principal"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorText,fontFamily:"monospace"},children:I(r==null?void 0:r.amount)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Interest Earned"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorWarning,fontFamily:"monospace"},children:I(((r==null?void 0:r.total_amount)||(r==null?void 0:r.amount))-(r==null?void 0:r.amount))})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Total Repayment"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:n.colorSuccess,fontFamily:"monospace"},children:I((r==null?void 0:r.total_amount)||(r==null?void 0:r.amount))})]})]})}),e.jsx("div",{style:{background:n.colorInfoBg,border:`1px solid ${n.colorInfoBorder}`,padding:"12px",borderRadius:"6px",fontSize:"13px",color:n.colorTextSecondary},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:n.colorInfo,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",color:"white"},children:"ðŸ“Š"}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:n.colorInfo},children:"Accounting Impact:"}),e.jsx("br",{}),"This will create journal entries: Cash â†” Loans Receivable + Interest Income"]})]})})]}),okText:"Mark as Repaid",okType:"primary"};case"delete":return{title:e.jsxs(K,{children:[e.jsx(Ee,{style:{color:"#ff4d4f"}}),e.jsx("span",{children:"Delete Loan"})]}),content:e.jsxs("div",{style:{color:n.colorText},children:[e.jsx("div",{style:{background:n.colorErrorBg,border:`1px solid ${n.colorErrorBorder}`,padding:"12px",borderRadius:"6px",marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:n.colorError,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",color:"white"},children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("div",{style:{color:n.colorError,fontWeight:600,fontSize:"14px",marginBottom:"4px"},children:"This action cannot be undone!"}),e.jsx("div",{style:{fontSize:"13px",color:n.colorTextSecondary},children:"You are about to permanently delete this loan."})]})]})}),e.jsx("div",{style:{background:n.colorBgElevated,border:`1px solid ${n.colorBorder}`,padding:"16px",borderRadius:"8px",marginBottom:"16px"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Member"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorText},children:(C=r==null?void 0:r.member)==null?void 0:C.name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Amount"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorText,fontFamily:"monospace"},children:I(r==null?void 0:r.amount)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Purpose"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:500,color:n.colorText},children:r==null?void 0:r.purpose})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",color:n.colorTextTertiary,textTransform:"uppercase",fontWeight:600,marginBottom:"4px"},children:"Status"}),e.jsx(he,{color:"orange",style:{fontSize:"11px",fontWeight:500,margin:0},children:r==null?void 0:r.status})]})]})}),e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("div",{style:{fontSize:"13px",color:n.colorTextSecondary,marginBottom:"8px"},children:"To confirm deletion, please type the member's name:"}),e.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:n.colorText,marginBottom:"8px",padding:"8px 12px",background:n.colorBgElevated,border:`1px solid ${n.colorBorder}`,borderRadius:"4px",fontFamily:"monospace"},children:(Me=r==null?void 0:r.member)==null?void 0:Me.name})]}),e.jsx(G,{placeholder:`Type "${(Fe=r==null?void 0:r.member)==null?void 0:Fe.name}" to confirm`,value:O.confirmText,onChange:ct=>V(dt=>({...dt,confirmText:ct.target.value})),style:{backgroundColor:n.colorBgContainer,borderColor:n.colorBorder,color:n.colorText}})]}),okText:"Delete Loan",okType:"danger"};default:return{}}},ot=s=>{g(s),ne.get(route("admin-portal.financials"),{...f,tab:s},{preserveState:!0,preserveScroll:!0})},rt=[{title:"Member",dataIndex:"name",key:"name",width:200},{title:"Email",dataIndex:"email",key:"email",width:200},{title:"Phone",dataIndex:"phone_number",key:"phone_number",width:150},{title:"Monthly Contributions",key:"monthly_total",width:150,render:(s,r)=>{const w=i[r.id]||0;return I(w)}},{title:"Actions",key:"actions",width:120,render:(s,r)=>e.jsx(L,{type:"link",onClick:()=>ne.visit(route("admin-portal.member-contributions",{member:r.id,year:F})),children:"View Details"})}],nt=[{title:"Member",dataIndex:["member","name"],key:"member_name",width:200},{title:"Amount",dataIndex:"amount",key:"amount",width:150,render:s=>I(s)},{title:"Date",dataIndex:"date",key:"date",width:150,render:s=>N(s).format("DD MMM YYYY")},{title:"Purpose",dataIndex:"purpose",key:"purpose",width:250},{title:"Notes",dataIndex:"notes",key:"notes",ellipsis:!0}],st=[{title:"Member",dataIndex:["member","name"],key:"member_name",width:180,render:s=>e.jsx("div",{style:{fontWeight:500,fontSize:"14px",color:n.colorText},children:s})},{title:"Principal",dataIndex:"amount",key:"amount",width:120,align:"right",render:s=>e.jsx("div",{style:{fontWeight:500,fontSize:"13px",color:n.colorText,fontFamily:"monospace"},children:I(s)})},{title:"Rate",dataIndex:"interest_rate",key:"interest_rate",width:80,align:"center",render:s=>e.jsxs(he,{color:"blue",style:{fontSize:"11px",fontWeight:500,margin:0},children:[s,"%"]})},{title:"Total Amount",dataIndex:"total_amount",key:"total_amount",width:130,align:"right",render:(s,r)=>e.jsx("div",{style:{fontWeight:600,fontSize:"13px",color:n.colorPrimary,fontFamily:"monospace"},children:I(s||r.amount)})},{title:"Purpose",dataIndex:"purpose",key:"purpose",width:160,ellipsis:!0,render:s=>e.jsx("div",{style:{fontSize:"13px",color:n.colorTextSecondary},children:s})},{title:"Status",dataIndex:"status",key:"status",width:100,align:"center",render:s=>{const w={pending:{color:"orange",text:"Pending"},disbursed:{color:"blue",text:"Disbursed"},repaid:{color:"green",text:"Repaid"}}[s]||{color:"default",text:s==null?void 0:s.toUpperCase()};return e.jsx(he,{color:w.color,style:{fontSize:"11px",fontWeight:500,margin:0,minWidth:"70px",textAlign:"center"},children:w.text})}},{title:"Date",dataIndex:"disbursement_date",key:"disbursement_date",width:100,align:"center",render:(s,r)=>e.jsx("div",{style:{fontSize:"12px",color:n.colorTextTertiary},children:s?N(s).format("MMM DD"):N(r.created_at).format("MMM DD")})},{title:"Actions",key:"actions",width:60,align:"center",fixed:"right",render:(s,r)=>{const w=[];return r.status==="pending"?w.push({key:"disburse",label:"Disburse",icon:e.jsx(ze,{}),onClick:()=>se(r,"disburse")},{key:"edit",label:"Edit",icon:e.jsx(Wt,{}),onClick:()=>Q(r)},{type:"divider"},{key:"delete",label:"Delete",icon:e.jsx(Ee,{}),danger:!0,onClick:()=>se(r,"delete")}):r.status==="disbursed"&&w.push({key:"repaid",label:"Mark as Repaid",icon:e.jsx(De,{}),onClick:()=>se(r,"repaid")}),e.jsx(_e,{menu:{items:w},trigger:["click"],disabled:w.length===0,placement:"bottomRight",children:e.jsx(L,{type:"text",icon:e.jsx(Ae,{}),size:"small",style:{color:n.colorTextTertiary,border:"none"}})})}}],at=[{title:"Member",dataIndex:["member","name"],key:"member_name",width:200},{title:"Amount",dataIndex:"amount",key:"amount",render:s=>I(s)},{title:"Reason",dataIndex:"reason",key:"reason",width:200},{title:"Month",dataIndex:"penalty_month",key:"penalty_month",render:s=>s?N(s+"-01").format("MMM YYYY"):"N/A"},{title:"Due Date",dataIndex:"due_date",key:"due_date",render:s=>N(s).format("DD MMM YYYY")},{title:"Status",dataIndex:"status",key:"status",render:s=>e.jsx(he,{color:s==="paid"?"green":"orange",children:s.toUpperCase()})},{title:"Actions",key:"actions",width:120,render:(s,r)=>e.jsx(_e,{menu:{items:[{key:"mark-paid",label:"Mark as Paid",icon:e.jsx(we,{}),disabled:r.status==="paid",onClick:()=>tt(r)}]},trigger:["click"],children:e.jsx(L,{type:"text",icon:e.jsx(Ae,{})})})}],it=[{title:"Member",dataIndex:["member","name"],key:"member_name",width:200},{title:"Amount",dataIndex:"amount",key:"amount",render:s=>I(s)},{title:"Date",dataIndex:"date",key:"date",render:s=>N(s).format("DD MMM YYYY")},{title:"Description",dataIndex:"description",key:"description",width:200}],lt=[{key:"contributions",label:"Monthly Contributions",children:e.jsxs("div",{style:{padding:"24px"},children:[e.jsx("div",{style:{marginBottom:"16px",display:"flex",justifyContent:"flex-end"},children:e.jsx(L,{type:"primary",icon:e.jsx(xe,{}),onClick:()=>ee("monthly"),size:"large",children:"Add Contribution"})}),e.jsx(U,{style:{marginBottom:"16px"},children:e.jsxs(Be,{gutter:[16,16],align:"middle",children:[e.jsx(Z,{xs:24,sm:12,md:8,children:e.jsx(G,{placeholder:"Search by member name...",prefix:e.jsx(Ne,{}),value:m,onChange:s=>j(s.target.value),allowClear:!0})}),e.jsx(Z,{xs:24,sm:6,md:4,children:e.jsx(H,{placeholder:"Year",value:F,onChange:s=>k(s),options:te,style:{width:"100%"}})}),e.jsx(Z,{xs:24,sm:6,md:4,children:e.jsx(H,{placeholder:"Month",value:E,onChange:s=>$(s),options:oe,style:{width:"100%"}})}),e.jsx(Z,{xs:24,md:8,style:{textAlign:"right"},children:e.jsxs(K,{children:[e.jsx(L,{type:"primary",onClick:re,children:"Apply"}),e.jsx(L,{onClick:de,children:"Clear"})]})})]})}),e.jsx(U,{title:"Monthly Contributions",children:e.jsx(M,{columns:rt,dataSource:t.data||t,rowKey:"id",pagination:t.data?{current:t.current_page,pageSize:t.per_page,total:t.total,onChange:s=>{ne.get(route("admin-portal.financials"),{...f,page:s})}}:{pageSize:10},scroll:{x:800}})})]})},{key:"other-contributions",label:"Other Contributions",children:e.jsxs("div",{style:{padding:"24px"},children:[e.jsx("div",{style:{marginBottom:"16px",display:"flex",justifyContent:"flex-end"},children:e.jsx(L,{type:"primary",icon:e.jsx(xe,{}),onClick:()=>ee("other"),size:"large",children:"Add Other Contribution"})}),e.jsx(U,{style:{marginBottom:"16px"},children:e.jsxs(Be,{gutter:[16,16],align:"middle",children:[e.jsx(Z,{xs:24,sm:12,md:8,children:e.jsx(G,{placeholder:"Search by member name...",prefix:e.jsx(Ne,{}),value:m,onChange:s=>j(s.target.value),allowClear:!0})}),e.jsx(Z,{xs:24,sm:6,md:4,children:e.jsx(H,{placeholder:"Year",value:F,onChange:s=>k(s),options:te,style:{width:"100%"}})}),e.jsx(Z,{xs:24,sm:6,md:4,children:e.jsx(H,{placeholder:"Month",value:E,onChange:s=>$(s),options:oe,style:{width:"100%"}})}),e.jsx(Z,{xs:24,md:8,style:{textAlign:"right"},children:e.jsxs(K,{children:[e.jsx(L,{type:"primary",onClick:re,children:"Apply"}),e.jsx(L,{onClick:de,children:"Clear"})]})})]})}),e.jsx(U,{title:"Other Contributions (Projects, Donations, etc.)",children:e.jsx(M,{columns:nt,dataSource:x.data||[],rowKey:"id",pagination:{pageSize:10},scroll:{x:800},summary:s=>{const r=s.reduce((w,B)=>w+parseFloat(B.amount||0),0);return e.jsx(M.Summary,{fixed:!0,children:e.jsxs(M.Summary.Row,{children:[e.jsx(M.Summary.Cell,{index:0,colSpan:1,children:e.jsx("strong",{children:"Total"})}),e.jsx(M.Summary.Cell,{index:1,children:e.jsx("strong",{children:I(r)})}),e.jsx(M.Summary.Cell,{index:2,colSpan:3})]})})}})})]})},{key:"loans",label:"Loans",children:e.jsx("div",{style:{padding:"24px"},children:e.jsx(U,{title:"Member Loans",extra:e.jsx(L,{type:"primary",icon:e.jsx(xe,{}),onClick:()=>b(!0),children:"Create Loan"}),children:e.jsx(M,{columns:st,dataSource:p.data||[],rowKey:"id",pagination:{pageSize:10,showSizeChanger:!1,showQuickJumper:!1,size:"small"},scroll:{x:900},size:"small",style:{backgroundColor:n.colorBgContainer},rowClassName:(s,r)=>r%2===0?"":"ant-table-row-striped",summary:s=>{const r=s.reduce((B,C)=>B+parseFloat(C.amount||0),0),w=s.reduce((B,C)=>B+parseFloat(C.total_amount||C.amount||0),0);return e.jsx(M.Summary,{fixed:!0,children:e.jsxs(M.Summary.Row,{style:{backgroundColor:n.colorBgElevated},children:[e.jsx(M.Summary.Cell,{index:0,children:e.jsx("strong",{style:{fontSize:"12px",color:n.colorText},children:"Total"})}),e.jsx(M.Summary.Cell,{index:1,align:"right",children:e.jsx("strong",{style:{fontSize:"12px",color:n.colorText,fontFamily:"monospace"},children:I(r)})}),e.jsx(M.Summary.Cell,{index:2}),e.jsx(M.Summary.Cell,{index:3,align:"right",children:e.jsx("strong",{style:{fontSize:"12px",color:n.colorPrimary,fontFamily:"monospace"},children:I(w)})}),e.jsx(M.Summary.Cell,{index:4,colSpan:4})]})})}})})})},{key:"penalties",label:"Penalties",children:e.jsx("div",{style:{padding:"24px"},children:e.jsx(U,{title:"Member Penalties",children:e.jsx(M,{columns:at,dataSource:h.data||[],rowKey:"id",pagination:{pageSize:10},scroll:{x:800}})})})},{key:"disaster-payments",label:"Disbursements",children:e.jsx("div",{style:{padding:"24px"},children:e.jsx(U,{title:"Disaster Payments",extra:e.jsx(L,{type:"primary",icon:e.jsx(xe,{}),onClick:()=>q(!0),children:"Add Disbursement"}),children:e.jsx(M,{columns:it,dataSource:d.data||[],rowKey:"id",pagination:{pageSize:10},scroll:{x:800}})})})}];return e.jsxs(e.Fragment,{children:[e.jsx(yt,{title:"Contributions - Tabata Welfare Association"}),e.jsxs(Ft,{children:[e.jsx("div",{style:{padding:"24px 0"},children:e.jsx(U,{style:{borderRadius:"12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)"},children:e.jsx(Rt,{items:lt,activeKey:T,onChange:ot})})}),P&&e.jsx(yo,{open:P,onClose:()=>R(!1),members:o,defaultType:z},z),e.jsx(jo,{open:W||!!J,onClose:()=>{b(!1),Q(null)},members:o,editingLoan:J}),e.jsx(So,{open:X,onClose:()=>q(!1),members:o}),e.jsx(je,{title:pe().title,open:O.open,onCancel:ue,onOk:me,okText:pe().okText,okType:pe().okType,cancelText:"Cancel",confirmLoading:O.loading,okButtonProps:{disabled:O.type==="delete"&&O.confirmText!==((Pe=(ke=O.loan)==null?void 0:ke.member)==null?void 0:Pe.name)},centered:!0,width:520,styles:{mask:{backgroundColor:"rgba(0, 0, 0, 0.45)"},body:{backgroundColor:n.colorBgContainer,padding:"20px"}},children:pe().content})]})]})}export{cr as default};
